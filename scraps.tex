\begin{lem} \label{lem:local_wrt_directed_complexes}
    Let \( C \) be a stricter \( n \)\nbd category and \( P \) be a \( n \)\nbd regular directed complex.
    Then \( C \) is local with respect to the canonical strict functor 
    \begin{equation*}
        s_P \colon \colim_{x \in P} \molecin{\imel{P}{x}} \to \molecin{P}.
    \end{equation*}
\end{lem}
\begin{proof}
    Consider a strict functor \( \F \colon \colim_{x \in P} \molecin{\imel{P}{x}} \to C \), and for \( x \in P \), denote by \( \F_x \) the restriction of \( \F \) along \( \molecin{\imel{P}{X}} \to \colim_{x \in P} \molecin{\imel{P}{x}} \).
    We define a strict functor \( \G \colon \molecin{P} \to C \) such that \( \G \after s_P = \F \).
    Let \( u \colon U \to P \) be a morphism with \( U \) an atom.
    Then \( u = \mapel{x} \) for some \( x \in P \), hence we must necessarily let \( \G(u) \eqdef \F_x(\idd{}) \).
    Since \( \atomin{P} \) is a basis for \( \molecin{P} \), this assignment uniquely determine \( \G \).
    We need to show that this indeed makes \( \G \) a strict functor.
    Let \( w \colon W \to P \) be a pasting diagram.
    We show that \( \G(w) \) does is independent on the decomposition of \( w \) into pasting of cells. 
    We proceed by induction on submolecules, the base case being evident.
    Inductively, suppose that \( \G(w') \) is well-defined for all proper subdiagrams \( w' \) of \( w \), and consider a proper decomposition \( w = w_1 \cp{k} w_2 \).
    Then we have a strict functor \( (\G_1, \G_2) \colon \molecin{W_1} \cup \molecin{W_2} \to C \), where \( \G_i \) is the restriction of \( \G \) along \( \molecin{w_i} \), which is well-defined by inductive hypothesis. 
    Since \( C \) is stricter, \( (\G_1, \G_2) \) extends to a strict functor \( \G' \colon \molecin{W} \to C \) with the property that \( \G'(u) = \G(u) \) for all \( u \in \atomin{P} \).
    This proved that \( \G \) is well-defined, and concludes the proof. 
\end{proof}


\begin{prop} \label{prop:density_of_pasting_diagram}
    Let \( C \) be a stricter \( \omega \)\nbd category.
    Then the canonical strict functor
    \begin{equation*}
        \phi \colon \colim_{u \in \Dgm(C)} \molecin{U} \to C,
    \end{equation*}
    is an isomorphism.
\end{prop}
\begin{proof}
    We show that \( C \) has the universal property of the colimit. 
    Consider a cone \( \set{\F_u \colon \molecin{U} \to D}_{u \in \Dgm(C)} \) for some stricter \( \omega \)\nbd category \( D \).
    We define a strict functor \( \F \colon C \to D \).
    Each globular cell \( c \) of \( C \) is classifies by a pasting diagram \( u \colon O^n \to C \), and therefore we must let \( \F(c) \eqdef \pcell{\F_u} \).
    This shows the uniqueness of the universal property.
    Let \( U \) be a molecule. 
    We must show that the diagram
    \begin{center}
        \begin{tikzcd}
            {\molecin{U}} \\
            C & D
            \arrow["u"', from=1-1, to=2-1]
            \arrow["{\F_u}", from=1-1, to=2-2]
            \arrow["\F"', from=2-1, to=2-2]
        \end{tikzcd}
    \end{center}
    commute.
    Let \( w \colon W \to U \) be a morphism with \( \dim w = n \).
    Then \( w \) is classified by a pasting diagram \( w' \colon \globe{n} \to \molecin{U} \), and by definition, \( \F \after u \after w' = \F_u \after w' \).
    Passing to the principal cells, we get that \( (\F \after u)(w) = \F_u(w) \).
    This shows that the diagram commutes.
    Now we need to proves that \( \F \) is indeed a strict functor, which is done by using the fact that \( C \) is stricter, the commutation of the previous diagram for all molecules \( U \), together with the strict functors
    \begin{equation*}
        \molecin{(\bd{k}{\a} \dglobe{n})} \to \molecin{\dglobe{n}}
    \end{equation*}
    classifying the morphism \( \bd{k}{\a} \dglobe{n} \to \dglobe{n} \), and  
    \begin{equation*}
        \molecin{\dglobe{n}} \to \molecin{(\dglobe{n} \cp{k} \dglobe{n})},
    \end{equation*}
    classifying the principal cell of \( \molecin{(\dglobe{n} \cp{k} \dglobe{n})} \).
    This concludes the proof.
\end{proof}

\begin{rmk} \label{rmk:thetas_are_dense}
    As it is the case for strict \( \omega \)\nbd categories, the previous result is still valid if one let the colimit run over pasting diagrams \( u \colon \molecin{U} \to C \), where \( U \) is a ``theta'', that is, a pasting of globes.
\end{rmk}


%% old folk model structure



% \begin{lem} \label{lem:j_n_weak_equivalence_cofibration}
%     Let \( n \geq 0 \).
%     Then \( j_n \) is both a stricter cofibration and an \( \omega \)\nbd equivalence.
% \end{lem}
% \begin{proof}
%     The strict functor \( j_n \) is a stricter cofibration as composite of two stricter cofibrations.
%     Furthermore, \( p \after j_n = \idd{\globe{n}} \).
%     By \cite[Proposition 20.1.17 and 20.1.13 ]{ara2025polygraphs} (which hold more generally for strict functors of composition structures), \( j_n \) is an \( \omega \)\nbd equivalence.
% \end{proof}

    % A globular \( n \)\nbd cell \( u \) in \( \Gamma(C) \) is therefore a strict functor \( u \colon \molec{(\arr \gray \dglobe{n})} \to C \), and we say that \( u \) is a \emph{reversible cylinder} if \( \pcell{u} \), as well as the principal cells of 
    % \begin{equation*}
    %    u \after \molecin{(\arr \gray \iota^\a_k)} \colon \molecin{(\arr \gray \dglobe{k})} \to C
    % \end{equation*}
    % are reversible, for each \( k \geq 0 \) and \( \a \in \set{-, +} \), where \( \iota^\a_k \) is the strict functor
    % \begin{equation*}
    %     \iota^\a_k \colon \molecin{(\bd{k}{\a} \dglobe{n})} \to \molecin{\dglobe{n}}.
    % \end{equation*} 
    % We then define the \emph{stricter \( \omega \)\nbd category of reversible cylinder} \( \rGamma(C) \) to be the stricter \( \omega \)\nbd category \( \rGamma(C) \subseteq \Gamma(C) \) on globular cells classifying reversible cylinders.

    % \begin{prop} \label{lem:stricter_cof_and_weak_stable_under_pushout}
%     The class of strict functors between stricter \( \omega \)\nbd categories that are both \( \omega \)\nbd equivalences and stricter cofibrations is closed under pushouts (in \( \somegaCat \)).
% \end{prop}
% \begin{proof}
%     Similar to the proof of \cite[Theorem 20.5.6]{ara2025polygraphs}, replacing ``cofibration'' with ``stricter cofibrations''.
% \end{proof}

\begin{dfn} [Relative stricter polygraph and stricter cofibration]
    Let \( f \colon C \to D \) be a strict functor of stricter \( \omega \)\nbd categories.
    We say that \( f \) is a \emph{relative stricter polygraph} if \( f \) can be written as a transfinite composition of pushouts (in \( \somegaCat \)) of elements of \( \Icof \).
    A retract of a relative stricter polygraph is called a \emph{stricter cofibration}.
\end{dfn}


% old and ugly rlp

% \begin{proof}
%     Let \( h \colon v \celto \compos{v} \) be a weak composite of \( v \), and \( z \colon f(u) \celto f(\compos{v}) \) be a weak composite of \( w \cp{} h \).
%     Since \( f \) has the right lifting property against \( \Jcomp \), \( z = f(z') \) for some equivalences \( z' \colon u \celto v' \).


%     Let \( h \colon f(v) \celto \compos{f(v)} \) be a weak composite, and \( z \colon f(u) \celto \compos{f(v)} \) be a weak composite of \( w \cp{} h \).
%     By Theorem \ref{thm:main_equivalence}, \( z \) is an equivalence, thus extends to \( \td{z} \colon f(u) \simeq \compos{f(v)} \).
%     By assumption, \( z = f(z') \) for some equivalence \( z \colon u \celto v' \).
%     Now, \( h \colon f(v) \)
% \end{proof}

% \begin{prop} \label{prop:relative_rlp_localisation}
%     Let \( f \colon Y \to W \) be a functor of \( (\infty, \infty) \)\nbd categories with the right lifting property against \( \Jcomp \), let \( (X, A) \) be a marked diagrammatic set, and consider lifting problem of the form
%     \begin{center}
%         \begin{tikzcd}
%             X & Y \\
%             {\loc X A} & W.
%             \arrow["u", from=1-1, to=1-2]
%             \arrow[from=1-1, to=2-1]
%             \arrow["f", from=1-2, to=2-2]
%             \arrow["{\td u}"', from=2-1, to=2-2]
%         \end{tikzcd}
%     \end{center}
%     Then the lifting problem admits a solution if and only if for each cell \( a \in A \), \( u(a) \) is an equivalence in \( Y \).
% \end{prop}
% \begin{proof}
%     If the lifting problem has a solution, clearly each of the \( u(a) \) is an equivalence in \( Y \).
%     Conversely, \( \loc{X}{A} \) is the colimit of the the sequence \( \order{n}{X} \incl \order{n + 1}{X} \) starting with \( \order{0}{X} \eqdef X \).
%     We let \( \iota_n \colon \order{n}{X}  \incl \loc{X}{A} \) be the canonical inclusion.
%     We define a lift \( \td{v} \colon \loc{X}{A} \to Y \) by successive extension along \( \order{n}{X} \incl \order{n + 1}{X} \), starting with \( \order{0}{v} \eqdef u \), and with the property that for all \( a \in \order{n}{A} \), \( \order{n}{v}(a) \) is an equivalence in \( Y \) and \( f \after \order{n}{c} = \td{u} \after \iota_n \).
%     Let \( n > 0 \) and consider \( a \in \order{n - 1}{A} \).
%     By inductive hypothesis, \( b \eqdef \order{n - 1}{v}(a) \colon c \celto d \) has left and right inverse \( b^L, b^R \colon d \celto c \), witnessed by the equivalences
%     \begin{equation*}
%         z \colon b \cp{} b^L \celto \un(c),\quad\quad h \colon \un(d) \celto b^R \cp{} b \celto \un(d).
%     \end{equation*}
%     By construction, \( f(b) \colon f(c) \celto f(d) \), which is equal to \( (\td{u} \after \iota_n)(a) \), has left and right inverses given by the cells \( f(b)^L \) and \( f(b)^R \), witnessed by the equivalences
%     \begin{equation*}
%         \hcyl{L}(f(b)) \colon f(b) \cp{} f(b)^L \celto \un f(c),\quad\quad \hcyl{R}(f(b)) \colon \un f(d) \celto f(b)^R \cp{} f(b).
%     \end{equation*}
%     % By Theorem \ref{thm:main_equivalence}, there are equivalences \( h^L \colon f(b^L) \celto f(b)^L \) and \( h^R \colon f(b^R) \celto f(b)^R \) in \( Y \), which, up to passing to a weak composites, we may assume to be cells.
%     Now consider the equations in \( W \)
%     \begin{equation*}
%         x \cpsub{f(b^L)} f(z) \qeq \hcyl{L}(f(b)^L) 
%     \end{equation*}
%     has a solution

%     Since \( f \) has the right lifting property against \( \Jcomp \), \( h^L = f(z^L) \) and \( h^R = f(z^R) \) for some equivalences \( z^L \colon b^L \celto b_0^L \) and \( z^R \colon b^R \celto b_0^R \).
%     Now
%     In particular, we may define
%     \begin{equation*}
%         \order{n}{v}(a^L) \eqdef b^L_0\quad\text{ and }\quad \order{n}{v}(b^L) \eqdef b^R_0.
%     \end{equation*}
%     Now we have the equivalences \( h \colon f(b) \cp{k} f(b)^L \celto \un f(c) \) and \( z \colon \un f(d) \celto f(b)^L \)
% \end{proof}

% \begin{rmk}
%     By \cite[Proposition 3.7]{chanavat2024model} an \( (\infty, \infty) \)\nbd category \( X \), a cell \( u \colon U \to X \) is an equivalence if an only if it extends to some \( \td u \colon \selfloc{U} \to X \).
%     Thus, a diagrammatic set \( X \) is an \( (\infty, n) \)\nbd category if and only if it has the right lifting property against \( \Jcomp \cup \Jn{n} \).
% \end{rmk}


% \begin{lem} \label{lem:isofib_rlp_double_walking}
%     Let \( n \in \mathbb{N} \cup \set{\omega} \), \( f \colon X \to Y \) be a functor of \( (\infty, n) \)\nbd categories with the right lifting property against \( \Jcomp \), and \( U \) be an atom of dimension \( > 0 \).
%     Then \( f \) has the right lifting property against 
%     \begin{equation*}
%         \selfloc{U} \incl \Loc (\selfloc{U}, \dgn \selfloc{U} \cup \set{U \incl \selfloc{U}}).
%     \end{equation*}
% \end{lem}
% \begin{proof}
%     Call \( \selfloc{U}^2 \eqdef \Loc (\selfloc{U}, \dgn \selfloc{U} \cup \set{U \incl \selfloc{U}}) \), and consider a lifting problem
%     \begin{center}
%         \begin{tikzcd}
%             {\selfloc{U}} & X \\
%             {\selfloc{U}^2} & Y.
%             \arrow["{\tilde u}", from=1-1, to=1-2]
%             \arrow[from=1-1, to=2-1]
%             \arrow["f", from=1-2, to=2-2]
%             \arrow["s"', from=2-1, to=2-2]
%         \end{tikzcd}
%     \end{center}
%     Then \( s \) classifies the extension \( f(\td{u}) \colon \selfloc{U} \to X \) of \( f(u) \), together with another extension \( \td{v} \colon \selfloc{U} \to X \).
%     Let \( u \colon a \celto b \) be the type of \( u \).
%     We let \( w \eqdef u \), and construct an extension \( \td{w} \colon \td{U} \to X \) of \( w \) such that \( f(\td{w}) = \td{v} \).
%     We proceed by induction on the construction of the localisation: we do the base case and leave the inductive step, which proceed along the same line, to the reader.
%     Let \( f(w)^L \) and \( v^L \) be the left inverses of \( f(w) \) attached at the first step of the localisation.
%     By Theorem \ref{thm:main_equivalence}, \( \td{e} \colon f(u)^L \simeq v^L \), where \( h \) is can be taken to be a cell, since \( Y \) is an \( (\infty, n) \)\nbd category.
%     Since \( f \) has the right lifting property against \( \Jcomp \), \( \td{e} = f(\td{e}') \), in particular \( v^L = f(w^L) \).
%     Then, one attaches \( \hinv{L}(v) \colon v \cp{} v^L \celto \un(f(a)) \) and \( \hinv{R} \colon \un(f(b)) \celto v^R \cp{} v \).
%     Since \( v \cp{} v^L = f(u \cp{} w^L) \) and \( \un(f(b)) = f(\un(b)) \), we have \( \hinv{L}(v) = f(\hinv{L}(w)) \) and \( \hinv{R}(v) = f(\hinv{r}(w)) \) for some equivalence \( \hinv{L}(w) \colon w \cp{} w^L \celto a' \) and \( \hinv{R}(w) \colon \un(b) \celto w^R \cp{} w \).
%     \cccom{TODO: a' is not necessarily a unit, fix that, or not?}
% \end{proof}

% \begin{lem} \label{lem:isofib_rlp_dual_comp}
%     Let \( n \in \mathbb{N} \cup \set{\omega} \), \( f \colon X \to Y \) be a functor of \( (\infty, n) \)\nbd categories with the right lifting property against \( \Jcomp \), and \( U \) be a round molecule.
%     Then \( f \) has the right lifting property against the inclusion \( U \incl \compos{U} \simeq U \).
% \end{lem}
% \begin{proof}
%     Consider a lifting problem
%     \begin{center}
%         \begin{tikzcd}
%             U & X \\
%             {\compos{U} \simeq U} & Y
%             \arrow["u", from=1-1, to=1-2]
%             \arrow[from=1-1, to=2-1]
%             \arrow["f", from=1-2, to=2-2]
%             \arrow["{\td h}"', from=2-1, to=2-2]
%         \end{tikzcd}
%     \end{center}
%     Consider a lift \( \td z \colon \compos{U}\simeq U \to X \) making the upper triangle commute.
%     Call \( V \eqdef \compos{U} \celto U \).
%     Then too solve the previous lifting problem, it is enough to solve
%     \begin{center}
%         \begin{tikzcd}
%             {\selfloc V} & X \\
%             {\Loc (\selfloc V,\set{\top_V})} & Y
%             \arrow["{\td z}", from=1-1, to=1-2]
%             \arrow[from=1-1, to=2-1]
%             \arrow["f", from=1-2, to=2-2]
%             \arrow["{\td h \cup f(\td z)}"', from=2-1, to=2-2]
%         \end{tikzcd}
%     \end{center}
%     which is possible by Lemma \ref{lem:isofib_rlp_double_walking}.
% \end{proof}

% \begin{lem} \label{lem:rlp_localised_horn_iff_rlp_weak_composite}
%     Let \( n \in \mathbb{N} \cup \set{\omega} \), and \( f \colon X \to Y \) be a functor of \( (\infty, n) \)\nbd categories.
%     The following are equivalent.
%     \begin{enumerate}
%         \item \( f \) has the right lifting property against \( \Loc \Jhorn \);
%         \item \( f \) has the right lifting property against \( \Jcomp \); 
%     \end{enumerate}
% \end{lem}
% \begin{proof}
%     The second condition is clearly necessary since \( \Jcomp \subseteq \Loc \Jhorn \).
%     Conversely, suppose that \( f \) has the right lifting property against \( \Loc \Jhorn \), and consider a marked horn \( \lambda^x_U \colon (\Lambda^x_U, B) \to (U, A) \).
%     Suppose without loss if generality that \( x \in \bd{}{-} U \).
%     Suppose also that \( x \notin A \), the proof in the other case follows similar lines.
%     Recall from \cite[Comment 3.13]{chanavat2024model} that a morphism \( s \colon \Loc (\Lambda^x_U, B) \to X \) classifying in \( X \) an equation \( \fun{E}x \qeq v \) in the indeterminate \( x \), where \( v \eqdef \restr{s}{\bd{}{+}U} \), and \( \fun{E} \) is a weakly invertible context in the sense of \cite[3.12]{chanavat2024equivalences}.
%     An extension of \( s \) along \( \lambda^x_U \) then classifies a solution \( u \), witnessed by \( \tilde{h} \colon \fun{E}u \simeq v \). 
%     Thus, by \cite[Lemma 5.10]{chanavat2024equivalences}, and passing to weak composites, all \( (\infty, n) \)\nbd categories have the right lifting property against \( \Loc \Jhorn \).
%     Now consider a lifting problem
%     \begin{center}
%         \begin{tikzcd}
%             {\Loc (\Lambda^x_U, B)} & X \\
%             {\Loc (U, A)} & Y
%             \arrow["s", from=1-1, to=1-2]
%             \arrow[from=1-1, to=2-1]
%             \arrow["f", from=1-2, to=2-2]
%             \arrow["{\tilde h}"', from=2-1, to=2-2]
%         \end{tikzcd}
%     \end{center}
%     and choose a lift \( \tilde{h}' \colon \Loc (U, A) \to X \) making the upper triangle commute. 
%     Then, \( \tilde{h} \cup f(\tilde{h'}) \) classify another equation \( x' \cpsub{} f(\tilde{h}) \qeq \tilde{h} \) in \( Y \), which admits a solution \( \tilde{w} \colon u \simeq f(u') \), witnessed by \( \tilde{z} \colon \tilde{w} \cpsub{} f(\tilde{h}') \celto \tilde{h} \)
%     By Lemma \ref{lem:isofib_rlp_dual_comp}, \( \tilde{w} = f(\tilde{w'}) \) for \( w' \colon \hat{u} \simeq u' \).
%     In particular, \( f(\hat{u}) = u \).
%     Thus \( \tilde{z} \) has type \( f(\tilde{w'} \cpsub{} \tilde{h}') \simeq \tilde{h} \).
%     By assumption and Lemma \ref{lem:isofib_rlp_double_walking} twice, \( \tilde{z} = f(\tilde{z'}) \) for some \( \tilde{z'} \colon \tilde{w'} \cpsub{} \tilde{k} \).
%     In particular, \( \tilde{k} \) classifies another solution in \( X \) of the equation given by \( s \) and \( f(\tilde{k}) = \tilde{h} \).
%     Therefore, \( \tilde{k} \colon \Loc (U, A) \) is the desired lift.  
% \end{proof}


\begin{dfn}
    Let \( \iota \colon (X, A) \incl (Y, B) \) be an inclusion of marked diagrammatic sets, and \( u \colon (L, C) \to (X, B) \) be a morphisms of diagrammatic sets. 
    We write \( u \in_\iota A \) if \( u \) factors through \( \iota \), and \( u \notin_\iota A \) otherwise.
\end{dfn}

\begin{lem} \label{lrm:relative_small_object_argument}\ccnote{define relative cell complex, change def of relative polygraph to relfect the definition}
    Let \( \iota \colon A \to X \) be an inclusion of diagrammatic sets, and \( J \) be a set of inclusions with the left lifting property against \( X \).
    Then there exists a factorisation of \( \iota \) into inclusions
    \begin{equation*}
        A \stackrel{j}{\incl} \order{\infty}{A} \incl X,
    \end{equation*}
    such that \( \order{\infty}{A} \) has the right lifting property against \( J \) and \( j \) is a relative \( J \)\nbd cell complex.
\end{lem}
\begin{proof}
    We construct \( \order{\infty}{A} \incl X \) by a transfinite induction of relative \( J \)\nbd cell complexes
    \begin{center}
        \begin{tikzcd}
            {A \eqdef \order{0}{A}} & {\order 1 A} & \ldots & {\order{n} A} & \ldots \\
            \\
            &&& X
            \arrow[hook, from=1-1, to=1-2]
            \arrow["{{\order 0 \iota \eqdef \iota}}"', curve={height=6pt}, hook, from=1-1, to=3-4]
            \arrow[hook, from=1-2, to=1-3]
            \arrow["{{\order 1 \iota}}"{description}, hook, from=1-2, to=3-4]
            \arrow[hook, from=1-3, to=1-4]
            \arrow[dashed, hook, from=1-3, to=3-4]
            \arrow[hook, from=1-4, to=1-5]
            \arrow["{{\order n \iota}}"{description}, hook, from=1-4, to=3-4]
        \end{tikzcd}
    \end{center}
    and such that \( \iota_n \) is an inclusion.
    The base case is \( (\order{0}{A}, \order{0}{\iota}) \eqdef (A, \iota) \).
    Let \( n > 0 \) and suppose inductively that \( \order{n - 1}{A} \) has been defined.
    Define \( \order{n}{S} \) by
    \begin{equation*}
        \coprod_{k \colon K \to L \in J} \set{(u \colon K \to \order{n - 1}{A}, v \colon L \to X) \mid v \after k = \order{n - 1}{\iota} \after u, v \notin_{\order{n - 1}{\iota}} \order{n - 1}{A} }.
    \end{equation*}
    Then define \( \order{n}{\iota} \colon \order{n}{A} \to X \) by the pushout
    \begin{center}
        \begin{tikzcd}
            {\coprod_{(k \colon K \to L, u, v) \in \order n S} K} & {\coprod_{(k \colon K \to L, u, v) \in \order n S} L} \\
            {\order{n - 1} A} & {\order n A} \\
            && X
            \arrow[""{name=0, anchor=center, inner sep=0}, "{\coprod k}", from=1-1, to=1-2]
            \arrow["{\coprod u}"', from=1-1, to=2-1]
            \arrow[from=1-2, to=2-2]
            \arrow["{\coprod v}", curve={height=-12pt}, from=1-2, to=3-3]
            \arrow[from=2-1, to=2-2]
            \arrow["{\order{n - 1} \iota}"{description}, curve={height=12pt}, hook, from=2-1, to=3-3]
            \arrow["{\order n \iota}"{description}, from=2-2, to=3-3]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
        \end{tikzcd}
    \end{center}
    We claim that \( \order{n}{\iota} \) is a monomorphism. 
    Inde
\end{proof}


%% cannot prove those results on strictification

% We recall that every surjective cartesian map \( p \colon U \to V \) of molecules factors uniquely into \( p = \ell \after f \) where \( \ell \) is a surjective morphism and \( f \) is a surjective final map.

% \begin{dfn} [Strict pasting diagram]
%     Let \( u \colon U \to X \) be a pasting diagram in a diagrammatic set. 
%     Then \( u \) factors uniquely as \( u = v \after \ell \after f \) where \( v \) is a non-degenerate pasting diagram, \( \ell \) is a surjective morphism and \( f \) is a surjective final map.
%     The \emph{strictification of \( u \)} is the diagram \( \s(u) \eqdef v \after \ell \).
%     We say that a diagram \( u \) is strict if \( u = \s(u) \).
% \end{dfn}

% \begin{lem}
    
% \end{lem}

% \begin{dfn} [Composition structure of strict pasting diagrams]
%     Let \( X \) be a diagrammatic set.
%     Then the \emph{composition structure of strict pasting diagrams of \( X \)} is the composition structure
%     \begin{equation*}
%         C \eqdef \set{u \in \Pd(X) \mid u \text{ strict}},
%     \end{equation*}
%     where, for \( k \geq 0 \), \( \a \in \set{-, +} \), \( \bd{k}{\a} \colon C \to C \) is the function \( u \mapsto \s(\bd{k}{\a} u) \)
% \end{dfn}

% \begin{prop} \label{prop:molecin_description}
%     Let \( X \) be a diagrammatic set.
% \end{prop}

\begin{rmk} \label{rmk:reflection_of_polygraph_is_stricter_polygraph}
    Since the functor \( \rcs \) is left adjoint, if a strict \( \omega \)\nbd category \( C \) is a polygraph in the traditional sense, then \( \rcs C \) is a stricter polygraph.
\end{rmk}


%% subdivide localisaiton

\begin{lem}
    Let \( X, Y \) be diagrammatic sets, \( \fun{F} \colon X \to Y \) be a strict functor, \( u \colon U \to X \) and \( v \colon V \to Y \) be cells, \( c \colon U \sd V \) be a subdivision such that \( \F \after \molecin{u} = \molecin{v} \after \molecin{c} \).
    Then there exists a strict functor \( \F' \colon \molecin{(\preloc{X}{u})} \to \molecin{(\preloc{Y}{v})} \) fitting in a pushout diagram
    \begin{center}
        \begin{tikzcd}
            {\molecin X} & {\molecin{(\preloc{X}{u})}} \\
            {\molecin Y} & {\molecin{(\preloc{Y}{v})}}
            \arrow[""{name=0, anchor=center, inner sep=0}, from=1-1, to=1-2]
            \arrow["\F", from=1-1, to=2-1]
            \arrow["{\F'}", from=1-2, to=2-2]
            \arrow[from=2-1, to=2-2]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
        \end{tikzcd}
    \end{center}
    where the horizontal strict functors are canonical.
\end{lem}
\begin{proof}
    To avoid overloading the notation, we avoid writing \( \molecin{-} \) in this proof.
    We then construct \( \F' \colon \preloc{X}{u} \to \preloc{Y}{v} \) in two steps.
    First we construct \( \F' \colon X' \to Y' \) by universal property
    \begin{center}
        \begin{tikzcd}
            {\bd{}{}U \coprod \bd{}{}U} & {U \coprod U} \\
            X & {X'} & {\bd{}{}V \coprod \bd{}{}V} & {V \coprod V} \\
            && Y & {Y'}
            \arrow[""{name=0, anchor=center, inner sep=0}, from=1-1, to=1-2]
            \arrow[from=1-1, to=2-1]
            \arrow[from=1-1, to=2-3]
            \arrow[dashed, from=1-2, to=2-2]
            \arrow["{c \coprod c}", from=1-2, to=2-4]
            \arrow[dashed, from=2-1, to=2-2]
            \arrow["\F"', from=2-1, to=3-3]
            \arrow["{\F'}", dashed, from=2-2, to=3-4]
            \arrow[""{name=1, anchor=center, inner sep=0}, from=2-3, to=2-4]
            \arrow[from=2-3, to=3-3]
            \arrow[from=2-4, to=3-4]
            \arrow[from=3-3, to=3-4]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=3-4, to=1]
        \end{tikzcd}
    \end{center}
    The top square is a pushout by Lemma \ref{lem:pushout_principal_cell}, thus so is the bottom one.
    \cccom{Really need some theory of subdivision}
\end{proof}


%%% counit 

\noindent We now investigate the counit of the adjunction \( \molecin{-} \dashv \N{} \).
% \begin{dfn}\ccnote{NO ClÃ©mence: nu is not a strict functor }
%     For any stricter \( \omega \)\nbd category \( C \) and atom \( U \), strict functors \( u \colon \molecin{U} \to C \) correspond naturally to cells \( u^\dagger \colon U \to \N{} C \).
%     By Corollary \ref{cor:molecin_polygraph_with_basis}, \( \molecin{\N{} C} \) is a stricter polygraph with basis
%     \begin{equation*}
%         \set{u \colon \molecin{U} \to C \mid u^\dagger \in \nd \N{}C}.
%     \end{equation*}
%     The counit \( \eps_C \colon \molecin{\N{}C} \to C \) is then defined on the basis by \( u \mapsto \pcell{u} \).
%     We let \( \nu_C \colon C \to \molecin{\N{} C} \) be the strict functor defined by sending a globular cell \( u \colon \globe{\dim u} \to C \) to \( \molecin{u^\dagger} \).
% \end{dfn}

% \begin{rmk}\label{rmk:nu_C_sends_to_basis}
%     The transpose of a globular cell \( u \colon \globe{\dim u} \to C \) is always non-degenerate.
%     Thus, by Corollary \ref{cor:molecin_polygraph_with_basis}, \( \nu_C \colon C \to \molecin{\N{} C} \) sends globular cells of \( C \) to elements of the basis of \( \molecin{\N{} C} \).
% \end{rmk}

% \begin{lem} \label{lem:eps_star_is_omega_eq}
%     Let \( C \) be a stricter \( \omega \)\nbd category.
%     Then \( \nu_C \) is an \( \omega \)\nbd equivalence. 
% \end{lem}
% \begin{proof}
%     Denote \( \nu \eqdef \nu_C \).
%     By Corollary \ref{cor:molecin_polygraph_with_basis}, the objects of \( \molecin{\N{} C} \) coincides with the \( 0 \)\nbd cells \( u \colon \pt \to \N{} C \).
%     Transposing, one sees that they corresponds in fact to the objects of \( C \), hence \( \nu \) is surjective on objects.
%     Let \( n > 0 \) and \( (c^-, c^+) \colon \bd{}{} \globe{n} \to C \) be a pair of parallel globular cells, and consider a globular cell \( u \colon \globe{n} \to \molecin{\N{}C} \) of type \( u \colon \nu(c^-) \gcelto \nu(c^+) \).
%     Since \( \molecin{\N{} C} \) the non-degenerate cells of \( \N{} C \) are a basis of \( \molecin{\N{} C} \) by Corollary \ref{cor:molecin_polygraph_with_basis}, we may show that \( u \sim \nu(v) \) for some globular cell \( v \colon c^- \gcelto c^+ \) in \( C \) by induction on the dimension, then the construction of \( u \).
%     We already established the case \( \dim u = 0 \).
%     Inductively, let \( n > 0 \).
%     Suppose first that \( u \) is an element of the basis, then necessarily \( u = \nu(\eps_C(u)) \).
%     Now suppose that \( u = u_1 \comp{k} u_2 \) for some \( k < n \), and \( u_i \colon u_i^- \gcelto u_i^+ \) for \( i \in \set{1, 2} \).
%     Suppose \( k < n - 1 \).
%     Let \( \a \in \set{-, +} \), then \( \nu(c^\a) = \bd{n - 1}{\a} u = u_1^\a \comp{k} u_2^\a \). 
%     By Remark \ref{rmk:nu_C_sends_to_basis}, this means that either \( \nu(c^\a) = u^\a_1 \) and \( u_2^\a = \nu(\bd{k}{+} c^\a) \), or \( \nu(c^\a) = u^\a_2 \) and \( u_1^\a = \nu(\bd{k}{-} c^\a) \).
%     In any case, we have for all \( i \in \set{1, 2} \) and \( \a \in \set{-, +} \), globular cells \( c^\a_i \) such that \( u_i \colon \nu(c_i^-) \gcelto \nu(c_i^+) \).
%     By inductive hypothesis, there exists both \( i \in \set{1, 2} \), globular cells \( v_i \colon c_i^- \gcelto c_i^+ \) such that \( u_i \sim \nu(v_i) \).
%     By Proposition \ref{prop:reversible_globular_cells}, \( u \sim \nu(v_1) \comp{k} \nu(v_2) = \nu(v_1 \comp{k} v_2 ) \).
%     Last, suppose that \( k = n - 1 \), so that \( u_1 \colon \nu(c^-) \gcelto w \) and \( u_2 \colon w \gcelto \nu(c^+) \).
%     Then, \( \dim w < n \) and either \( n = 1 \) and \( w \) is an object, or \( w \colon \nu(\bd{n - 2}{-} c^-) \gcelto \nu(\bd{n - 2}{+} c^-) \).
%     In any case, by inductive hypothesis on the dimension, we have a globular cell \( w' \colon \bd{n - 2}{-} c^- \gcelto \bd{n - 2}{+} c^- \)
%     \cccom{does not work unless one shows first that nu is a fibration, which it is not}
% \end{proof}

% \begin{thm} \label{thm:cofibrant_replacement_counit_infty}
%     Let \( C \) be a stricter \( \omega \)\nbd category.
%     Then the (derived) counit \( \eps_C \colon \molecin{\N{} C} \to C \) is an acyclic fibration in the folk model structure on stricter \( \omega \)\nbd categories.
% \end{thm}
% \begin{proof}\ccnote{very much false}
%     Notice that for all \( n \geq 0 \), a globular cell \( u \colon \globe{n} \to C \) of \( C \) is equivalent, by transposing along the adjunction \( \molecin{-} \dashv \N{} \), to a cell \( u^\dagger \colon \dglobe{n} \to \N{} C \).
%     Let \( n \geq 0 \) and consider a lifting problem of the form
%     \begin{center}
%         \begin{tikzcd}
%             {\bd{}{}\globe n} & {\molecin{\N{}C}} \\
%             {\globe n} & C
%             \arrow["{(v^-, v^+)}", from=1-1, to=1-2]
%             \arrow[from=1-1, to=2-1]
%             \arrow["\eps_C", from=1-2, to=2-2]
%             \arrow["u"', from=2-1, to=2-2]
%         \end{tikzcd}
%     \end{center}
%     We claim that \( \molecin{u^\dagger} \colon \globe{n} \to \molecin{\N{} C} \) solves the lifting problem. 
%     Indeed, \( u = \eps_C \after \molecin{u^\dagger} \) by adjunction.
%     Then for \( \a \in \set{-, +} \), 
%     \begin{equation*}
%         \bd{}{\a} (\molecin{u^\dagger}) = \molecin{(\bd{}{\a} u^\dagger)} = \molecin{(\bd{}{\a}u)^\dagger} = \molecin{(v^\a)^\dagger}.
%     \end{equation*}  
%     By adjunction again, \( \eps_C \after \bd{}{\a} (\molecin{u^\dagger}) = v^\a \).
%     This concludes the proof.
% \end{proof}

\cccom{Strategy}
\begin{itemize}
    \item define the function \( \nu \colon C \to \molecin{\N{}C} \), show by induction on \( n \) that all \( n \) dom globular cell of \( c \) of \( \molecin{\N{} C} \) are such that there is a reversible cylinder \( c \to \nu(\eps(c)) \) that is mapped via \( \eps \) to the identity (use the weak composite of \( \N{} C \) mapped, which generated basis element mapped to identity in \( C \))
    \item probably it is not possible without some kind of description of the elements of \( \molecin{\N{}C} \), in that \( \molecin{u} \) for \( u \in \Pd \N{} C \) is appropriately surjective. It is the case on the basis, but there are more possible compositions in \( \molecin{\N{}C} \) that there is a priori in \( \N{} C \), so this is quite difficult.
\end{itemize}


\begin{thm} \label{thm:cofibrant_replacement_counit_n}
    Let \( n \in \mathbb{N} \) and \( C \) be a stricter \( n \)\nbd category. 
    The the (derived) counit \( \eps_C \colon \N{n}\trunc{n}\molecin{C} \to C \) is an acyclic fibration in the folk model structure for stricter \( n \)\nbd categories.
\end{thm}
\begin{proof}
    \cccom{TODO}
\end{proof}

\subsection{Counit and cofibrant replacement}

\cccom{globe-like diagrammatic sets, restriction is acyclic-cofibration, stricter polygraph on globe like can recover all glob cell as pasting diagrams of theta}


\begin{lem} \label{lem:gray_determines_strict_functors}
    Let \( P, Q, P', Q' \) be regular directed complexes, and \( \F \colon \molecin{P} \to \molecin{P'} \), \( \G \colon \molecin{Q} \to \molecin{Q'} \) be strict functors.
    Then \( \F \gray \G \) extends to a strict functor 
    \begin{equation*}
        \F \gray \G \colon \molecin{P} \gray \molecin{Q} \to \molecin{P'} \gray \molecin{Q'}.
    \end{equation*}
\end{lem}
\begin{proof}
    Let \( w \colon W \to P \gray Q \) be a morphism.
    We show by induction on \( n \eqdef \dim w \) that \( (\F \gray \G) \after \molecin{w} \) is well-defined. 
    The base case where \( n = 0 \) is clear.
    Inductively, suppose that \( n > 0 \).
    We show that for all 
    We show by induction on the dim morphism mi
\end{proof}


%%% ol stricter are strict
    % Recall from \cite[Theorem 5.2.5]{hadzihasanovic2024combinatorics} that pasting and boundaries makes the collection of molecules a strict \( \omega \)\nbd categories. 
    % We first show the axioms of interaction between pasting and boundaries. 
    % Let \( c \colon O^{m} \to C \) and \( d \colon O^{m'} \to C \) be \( k \)\nbd composable cells in \( C \).
    % The pasting diagram \( c \cp{k} d \colon \molecin{(O^m \cp{k} O^{m'})} \) is such that \( \pcell{c \cp{k} d} = \pcell{c} \comp{k} \pcell{d} \).
    % Let \( n \geq 0 \) and \( \a \in \set{-, +} \), then
    % \begin{equation*}
    %      \bd{n}{\a} (\pcell{c} \comp{k} \pcell{d}) = \bd{n}{\a} \pcell{c \cp{k} d} = \pcell{\bd{n}{\a} (c \cp{k} d)},
    % \end{equation*}
    % the latter being equal to
    % \begin{equation*}
    %     \begin{cases}
    %         \pcell{\bd{n}{\a} c} = \bd{n}{\a} \pcell{c} = \bd{n}{\a} \pcell{d} & \text{if } n < k,\\
    %         \pcell{\bd{k}{-}c} = \bd{k}{-}\pcell c & \text{if } n = k, \a = -,\\
    %         \pcell{\bd{k}{+}d} = \bd{k}{+}\pcell d & \text{if } n = k, \a = +,\\
    %         \pcell{\bd{k}{\a}c \cp{k} \bd{k}{\a} d} = \bd{k}{\a}\pcell c \comp{k} \bd{k}{\a} \pcell d & \text{if } n > k.
    %     \end{cases}
    % \end{equation*}
    % Next is unitality.
    % Let \( c \colon O^m \to C \) be a cell, and \( k \geq 0 \).
    % Then we have the pasting diagram \( c \cp{k} \bd{k}{+} c \colon \molecin{(O^m \cp{k} \bd{k}{+} O^m)} \to C \).
    % Since \( (O^m \cp{k} \bd{k}{+} O^m) = O^m \), the principal cell of \( c \cp{k} \bd{k}{+} c \) is \( \pcell{c} \).
    % This shows that \( \pcell{c} \comp{k} \bd{k}{+} \pcell{c} = \pcell{c} \).
    % Similarly, \(  \bd{k}{-} c \comp{k} \pcell{c} = \pcell{c} \).
    % Next, we consider the axiom of associativity. 
    % Let \( c, d, e \) be \( k \)\nbd composable cell in \( C \).
    % Then again, we have a pasting diagram \( c \cp{k} d \colon \molecin{(\dglobe{m} \cp{k} \dglobe{m'})} \to \C \).
    % Then we may paste \( c \cp{k} d \) and \( e \) to obtain a pasting diagram 
    % \begin{equation*}
    %     (c \cp{k} d) \cp{k} e \colon \molecin{(\dglobe{m} \cp{k} \dglobe{m'} \cp{k} \dglobe{m''})} \to C,
    % \end{equation*}
    % whose principal cell is \( (\pcell c \comp{k} \pcell d) \comp{k} \pcell{e} \).
    % Similarly, we have a pasting diagram
    % \begin{equation*}
    %     c \cp{k} (d \cp{k} e) \colon \molecin{(\dglobe{m} \cp{k} \dglobe{m'} \cp{k} \dglobe{m''})} \to C,
    % \end{equation*}
    % whose principal cell is \( \pcell c \comp{k} (\pcell d \comp{k} \pcell{e}) \).
    % By Lemma \ref{lem:strict_functor_determined_by_basis}, 
    % \begin{equation*}
    %      (c \cp{k} d) \cp{k} e = c \cp{k} (d \cp{k} e),
    % \end{equation*}
    % hence their principal cells are equal as well.
    % Proceed similarly for exchange.
    % This concludes the proof.


% \begin{dfn}
%     For each \( n \in \mathbb{N} \cup \set{\omega} \), we call \( \fun{W}_n \) be the collection of weak equivalences of the \( (\infty, n) \)\nbd model structure on diagrammatic sets, and \( \fun{W}^{\m{}}_n \) the collection of weak equivalences of the coinductive \( (\infty, n) \)\nbd model structures on marked diagrammatic sets.
% \end{dfn}
% \begin{rmk}

%     Then we have a sequence of inclusions
%     \begin{equation*}
%         \fun{W}_{\infty} \subseteq \ldots \subseteq \fun{W}_{n + 1} \subseteq \fun{W}_n \subseteq \ldots \subseteq \fun{W}_0.
%     \end{equation*}
%     Thus, if a certain morphism of diagrammatic sets is proven to belong to \( \fun{W}_n \), it also belongs to \( \fun{W}_k \) for all \( k \le n \).
%     This discussion applies equally for the weak equivalences \( \fun{W}^{\m{}}_n \).
% \end{rmk}

% \begin{prop} \label{prop:loc_preserves_weak_equivalences} \cccom{do we need that?}
%     Let \( n \in \mathbb{N} \cup \set{\omega} \).
%     Then \( \Loc \fun{W}^{\m{}}_n = \fun{W}_n \).
% \end{prop}
% \begin{proof}
%     Let \( f \colon (X, A) \to (Y, B) \) in \( \fun{W}^{\m{}}_n \).
%     By Theorem \ref{thm:n_model_structure_on_dgm_set}, \( \Loc f \) is in \( \fun{W}_n \) if and only if \( \minmark{(\Loc f)} \) is in \( \fun{W}^{\m{}}_n \).
%     Now for all marked diagrammatic sets \( (Z, C) \), \( (Z, C) \incl (\loc{Z}{C}, C \cup \dgn (\loc{Z}{C})) \) is in \( \fun{W}^{\m{}}_n \) by \cite[Lemma 4.17]{chanavat2024model}.
%     Then the marking \( \minmark{(\Loc (Z, C))} \incl (\loc{Z}{C}, C \cup \dgn (\loc{Z}{C})) \) also belongs to \( \fun{W}^{\m{}}_n \) since it can be constructed as a transfinite composition of pushout along markings of the form
%     \begin{equation*}
%         \minmark{\selfloc{U}} \incl (\selfloc{U}, \set{U \incl \selfloc{U}} \cup \dgn \selfloc{U}), U \text{ atom},
%     \end{equation*}
%     which belong to \( \fun{W}^{\m{}}_n \) by definition of the coinductive \( (\infty, n) \)\nbd model structure.
%     By the two-out-of-three, we conclude that \( \minmark{(\Loc f)} \) is in \( \fun{W}^{\m{}}_n \).
%     Conversely, \( \minmark{\fun{W}_n} \subseteq \fun{W}^{\m{}}_n \), and by the first part of the proof
%     \begin{equation*}
%         \fun{W}_n = \Loc \minmark{\fun{W}_n} \subseteq \Loc \fun{W}^{\m{}}_n.
%     \end{equation*}
%     This concludes the proof.
% \end{proof}

% \begin{lem}\label{lem:acyclic_on_globes_acyclic_on_all}
%     Let \( f \colon X \to Y \) be a fibration of \( (\infty, n) \)\nbd categories, and suppose that \( f \) has the right lifting property against
%     \begin{equation*}
%         \set{\bd{}{} \dglobe{n} \incl \dglobe{n} \mid n \geq 0}.
%     \end{equation*}
%     Then \( f \) is an acyclic fibration.
% \end{lem}


% \begin{dfn} [Globularisation]
%     Given a round molecule \( V \), we define the atoms \( C^+(V) \eqdef (V \celto \compos{V}) \) and \( C^-(V) \eqdef (\compos{V} \celto V) \).
%     Let \( U \) be an atom of dimension \( n \geq 2 \), we let
%     \begin{equation*}l
%         R(U) \eqdef C^-(\bd{}{-}U) \cp{n - 1} (\ldots \cp{2} C^-(\bd{1}{-}U) \cp{1} U \cp{1} C^+(\bd{1}{+} U) \cp{2} \ldots) \cp{} C^+(\bd{}{+}U),
%     \end{equation*}
%     and let \( G(U) \eqdef R(U) \celto \dglobe{n} \) and \( L(U) \eqdef G(U) \setminus \set{\top_{G(U)}, \top_U} \).
%     Now, calling \( \top^\a_k \) be the maximal element of \( \C^\a(\bd{k}{\a} U) \) in \( R(U) \) for \( \a \in \set{-, +} \) and \( 1 \le k \le n - 1 \), we get that
%     \begin{equation*}
%         \lambda^{\top_U} \colon (L(U), \bigcup_{k = 1}^{n - 1} \set{\top^\a_k}) \incl (G(U), {\top_{G(U)}, \top_U} \cup \bigcup \bigcup_{k = 1}^{n - 1} \set{\top^\a_k})
%     \end{equation*}
%     is a marked horn. 
%     The \emph{globularisation} of \( U \) is the morphism of diagrammatic set
% \end{dfn}

% \begin{prop}\label{prop:infty_n_cat_htpy_colimit_of_its_globes}
%     Let \( n \in \mathbb{N} \cup \set{\omega} \), \( Y \) be an \( (\infty, n) \)\nbd category, and \( \iota \colon X \subseteq Y \) a subpresheaf of \( Y \) such that for all \( n \geq 0 \), \( X(\dglobe{n}) = Y(\dglobe{n}) \).
%     Then \( \iota \) is an acyclic cofibration in the \( (\infty, n) \)\nbd model structure.
% \end{prop}
% \begin{proof}
%     Factors \( \iota = f \after j \) where \( j \colon X \to X' \) is an acyclic cofibration and \( p \colon X' \to Y \) is a fibration.
%     In particular, \( X' \) is fibrant. 
%     We show by induction on \(  \) 
%     Consider a lifting problem 
%     \begin{center}
%         \begin{tikzcd}
%             {\bd{}{} \dglobe{n}} & {X'} \\
%             {\dglobe{n}} & Y
%             \arrow[from=1-1, to=1-2]
%             \arrow[hook', from=1-1, to=2-1]
%             \arrow["f", from=1-2, to=2-2]
%             \arrow["u"', from=2-1, to=2-2]
%         \end{tikzcd}
%     \end{center}
%     By assumption \( u = \iota \after v \) for some \( v \colon \dglobe{n} \to A \).
%     Then 
% \end{proof}

% \subsection{Adjoint equivalences}

% \begin{dfn} [Adjunction in a diagrammatic set]
%     Let \( \ell \colon u \celto v \) and \( r \colon v \celto u \) be round diagrams in a diagrammatic set.
%     We say that \( \ell \) is left adjoint to \( r \), and write \( \ell \dashv r \) if there exists a sequence of round diagrams \( (\counit_n, \unit_n)_{n \geq 1} \), whose type is defined inductively as follows. 
%     \begin{itemize}
%         \item for the base case, \( \unit_1 \colon \un(u) \celto \ell \cp{} r \) and \( \counit_1 \colon r \cp{} \ell \celto \un(v) \).
%         \item for all \( n > 2 \)
%     \end{itemize}
% \end{dfn}

% very much false conjecture
\noindent Finally, we conjecture how we believe that results of this section could be generalised to more general enrichment than the suspension.
% \begin{dfn}[Acyclic enrichment]
%     Let \( C \) be an enriched category.
%     We say that \( C \) is \emph{acyclically enriched} if 
%     \begin{enumerate}
%         \item for all objects \( a \) of \( C \), \( C(a, a) \) is isomorphic to the monoidal unit and
%         \item the preorder on \( \Ob C \) defined by \( a \le b \) if and only if \( C(a, b) \) is not an initial object, is antisymmetric. 
%     \end{enumerate}
% \end{dfn}

% \begin{conj} \label{conj:acyclic_enrichment}
%     Let \( C \) be an acyclically enriched category in stricter \( \omega \)\nbd categories.
%     Then \( C \) is a stricter \( \omega \)\nbd category.
% \end{conj}

% \noindent An attempt to solve the conjecture would follow the same proof that Theorem \ref{thm:suspension_of_stricter}, by considering a strict functor of composition structure \( \F \colon \molecin{U} \to C \), and factoring it through a molecule
% \begin{equation*}
%     \sus{\order{1}{V}} \cp{0} \ldots \cp{0} \sus{\order{n}{V}},
% \end{equation*} 
% obtained by collapsing a partition of \( \gr{0}{U} \) in \( U \), as in Proposition \ref{prop:desuspension}.
% The acyclicity condition would ensure that the partition is ``correctly ordered'' in \( U \), so that the resulting quotient is indeed a molecule.




\noindent We will give an analogue of Theorem \ref{thm:folk_model_structure}, with \( \somegaCat \) in place of \( \omegaCat \).
% We let 
% \begin{equation*}
%     \Icof \eqdef \set{i_n \colon \bd{}{} \globe{n} \incl \globe{n} \mid n \geq 0}.
% \end{equation*}
% By the small object argument in \( \somegaCat \), each strict functor \( f \colon C \to D \) of stricter \( \omega \)\nbd categories factors as \( f = p i \) where \( i \) is a relative stricter polygraph and \( p \) has the right lifting property against \( \Icof \), that is, \( p \) is an acyclic cofibration.

% \begin{dfn} \label{dfn:generating_folk_acyclic_cof}
%     For each \( n \geq 0 \), consider the strict functor \( \bd{}{} \globe{n + 1} \to \globe{n} \) sending the two non-trivial globular \( n \)\nbd cells of \( \bd{}{} \globe{n + 1} \) to the only non-trivial globular cell of \( \globe{n} \).
%     We fix a factorisation of this strict functor
%     \begin{equation*}
%         \bd{}{} \globe{n + 1} \stackrel{j}{\to} \swE{n + 1} \stackrel{p}{\to} \globe{n}
%     \end{equation*}
%     into a stricter cofibration followed by an acyclic fibration, and let \( j_n \) be the composite
%     \begin{equation*}
%         \globe{n} \incl \bd{}{} \globe{n + 1} \stackrel{j}{\to} \swE{n + 1},
%     \end{equation*}
%     where \( \globe{n} \incl \bd{}{} \globe{n + 1} \) is the ``source'' inclusion, that is, the one factoring through \( \molecin{(\bd{}{-}\dglobe{n + 1})} \incl \molecin{\dglobe{n + 1}} \).
%     We let
%     \begin{equation*}
%         \sJcof \eqdef \set{j_n \colon \globe{n} \to \swE{n + 1} \mid n \geq 0}.
%     \end{equation*}  and a generating set is given by \( \Icof \).
% \end{dfn}


% \begin{dfn} [Acyclic fibration] \label{dfn:acyclic_fibration} \ccnote{since now we do not talk about acyclic fib, there is no need for that}
%     Let \( f \colon C \to D \) be a strict functor of compositions structures.
%     We say that \( f \) is an \emph{acyclic fibration} if
%     \begin{enumerate}
%         \item \( f \) is surjective on objects;
%         \item for each \( n \geq 0 \), each pair \( c, c' \) of parallel \( n \)\nbd cells of \( C \), and each \( (n + 1) \)\nbd cell \( v \colon f(c) \celto f(c') \), there exists a \( (n + 1) \)\nbd cell \( u \colon c \celto c' \) such that \( f(u) = v \)
%     \end{enumerate}
% \end{dfn}

% \begin{dfn} [Unit on a diagram]
%     Let \( C \) be a composition structure and \( u \colon \molecin{U} \to C \) be a diagram.
%     Then \emph{unit on \( u \)} is the diagram \( \un(u) \eqdef u \after \molecin{\tau_{\bd{}{} U}} \), where \( \bd{}{} U \colon \dglobe{1} \pcyl{\bd{}{} U} U \surj U \) is the canonical surjection.
% \end{dfn}

% \begin{rmk}
%     By definition of \( \molecin{\tau_{{\bd{}{} U}}} \), we have \( \pcell{u} = \pcell{\un(u)} \).
% \end{rmk}

% \begin{dfn} [Reversible cell] \ccnote{in fact, we might not even need that anymore.}
%     Let \( C \) be a composition structure, and \( e \colon u \celto v \) be a cell of dimension \( n > 0 \) in \( C \).
%     We say that \( e \) is reversible if there exists a cell \( e^* \colon v \celto u \), as well as cells \( h \colon e \comp{n - 1} e^* \celto \un(u) \) and \( h' \colon e^* \comp{n - 1} e \celto \un(v) \) such that \( h \) and \( h' \) are reversible.
%     In that case, \( e^* \) is called a \emph{weak inverse} of \( e \).
%     We write \( u \simeq v \) if there exists a reversible cell \( e \) of type \( u \celto v \).
% \end{dfn}

% \begin{dfn} [\( \omega \)\nbd equivalence]
%     Let \( f \colon C \to D \) be a strict functor of composition structures.
%     We say that \( f \) is an \( \omega \)\nbd equivalence if
%     \begin{enumerate}
%         \item for each cell \( d \) in \( D \) of dimension \( 0 \), there exists a cell \( c \) in \( C \) such that \( f(c) \simeq d \);
%         \item for each \( n \geq 0 \), each pair \( c, c' \) of parallel \( n \)\nbd cells of \( C \), and each \( (n + 1) \)\nbd cell \( v \colon f(c) \celto f(c') \), there exists a \( (n + 1) \)\nbd cell \( u \colon c \celto c' \) such that \( f(u) \simeq v \)
%     \end{enumerate}
% \end{dfn}

% \begin{comm}
%     The definitions of acyclic fibration, reversibility, and \( \omega \)\nbd equivalence make sense in any composition structure, in particular in a strict or stricter \( \omega \)\nbd category.
%     In the former case, we recover the usual definitions, see for instance \cite[19.2.3, 20.1.1, 20.1.11]{ara2025polygraphs}.
% \end{comm}

% \begin{thm} \label{thm:folk_model_structure}
%     There exists a model structure, called the \emph{folk model structure}, on \( \omegaCat \) such that:
%     \begin{enumerate}
%         \item the weak equivalences are the \( \omega \)\nbd equivalences;
%         \item the acyclic fibrations are the one of Definition \ref{dfn:acyclic_fibration};
%         \item every strict \( \omega \)\nbd category is fibrant. 
%     \end{enumerate} 
% \end{thm}
% \begin{proof} 
%     See \cite{lafont2010folk}.
% \end{proof}

% \begin{comm}
%     The careful reader will have noticed that the construction of \( \wE \) is slightly different than the one given in \cite{hadzihasanovic2024model}.
%     Indeed, we define \( \fun{R}_1 \) by \( \sus{x} \mapsto y, \sus{y} \mapsto a^R \comp{0} a \), whereas in the original version, the authors define \( \fun{R}_1 \) by \( \sus{x} \mapsto a^R \comp{0} a, \sus{y} \mapsto y \).
%     We made this slight adjustment in order to match the convention of the definition of the localisation (\ref{dfn:localisation}), so that Lemma \ref{lem:swE_is_iso_to_molecin_loc_globe} holds. 
%     The reader can be assured that this difference is inessential and the main results of \cite{hadzihasanovic2024model} still hold for \( \wE \).
% \end{comm}


% If the primary justification of the exchange law is algebraic, our motivation to introduce higher exchanges is geometric. 
% Each decomposition of a molecule into pasting reflects a universal property of its associated topological space. 
% Another justification for the axioms of strict \( \omega \)\nbd categories stems from the combinatorics of higher categorical diagrams.
% In this perspective an higher categorical diagram is a cell complex together with the data of an orientation  
% directed combinatorial topology.
% In this perspective, the equations sa
% The axiom of strict \( \omega \)\nbd category should be given by the axiom of the combinatorics of pasting diagrams.
% Here, by pasting diagram we mean a combinatorial  
% If one consider the class \( \underline{\Theta} \) of regular CW complexes generated by the closure under (bipointed) suspension and wedge sum  that is, by taking a pushout, along boundaries   

% It turns out that the family consisting of the directed cellular isomorphisms representing the unitality, associativity, the exchange laws (in all of the possible dimensions) generates the whole family of directed cellular isomorphisms in \( \underline{Theta} \).
% This suggest once again that the axioms     

% \cccom{The following is too long, cut to the chase}
% We discussed it, a first justification for the exchange rule is algebraic, we want lower dimensional composition to be functorial over higher dimensional composition. 
% It turns out that the algebraic picture is equivalent to a topological one.
% A natural starting point is to view the globes, which are the underlying shape of the elements in a higher category, as genuine topological balls realised as the canonical CW complex encoded by in the combinatorics of its boundary operators.   
% For instance, the 2-globe \( \dglobe{2} \) is the regular CW complex 
% \begin{center}
%     \begin{tikzcd}[sep=large]
%         {0^-} & {0^+},
%         \arrow[""{name=0, anchor=center, inner sep=0}, "{1^-}"', curve={height=12pt}, from=1-1, to=1-2]
%         \arrow[""{name=1, anchor=center, inner sep=0}, "{1^+}", curve={height=-12pt}, from=1-1, to=1-2]
%         \arrow["2", between={0.2}{0.8}, Rightarrow, from=0, to=1]
%     \end{tikzcd}
% \end{center}
% whose face poset consists of five elements \( \set{0^-, 0^+ < 1^-, 1^+ < 2} \), representing respectively \( \bd{0}{-} \dglobe{2}, \bd{0}{+} \dglobe{2}, \bd{1}{-} \dglobe{2}, \bd{1}{+} \dglobe{2} \), and \( \dglobe{2} \) itself.  
% It should be noted that all such CW complexes are directed, in that each \( k \)\nbd cell in the boundary of a \( (k + 1) \)\nbd cell is either in the ``input'' or the ``output'' boundary of that \( (k + 1) \)\nbd cell.
% In the setting of directed regular CW complex, the notion of ``sameness'' is prescribed by cellular isomorphism that also respects the direction and the notion of input and output \( k \)\nbd boundary can be described combinatorially by a subcomplex inclusion \( i^\alpha_k \colon \bd{k}{\a} U \incl U \).
% Then, the \( k \)\nbd composition is embodied by the operation of \emph{pasting along the \( k \)\nbd boundary}, in that if two such complexes \( U \) and \( V \) are such that there is a directed cellular isomorphism \( \phi \colon \bd{k}{+} U \cong \bd{k}{-} V \), the pasting \( U \cp{k} V \) is defined as the pushout 
% \begin{center}
%     \begin{tikzcd}
%         { \bd{k}{+} U \stackrel\phi\cong \bd{k}{-} V} & V \\
%         U & {U \cp{k} V}
%         \arrow[""{name=0, anchor=center, inner sep=0}, hook, from=1-1, to=1-2]
%         \arrow[hook', from=1-1, to=2-1]
%         \arrow[from=1-2, to=2-2]
%         \arrow[from=2-1, to=2-2]
%         \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
%     \end{tikzcd}
% \end{center}
% in topological spaces, with its canonical directed cellular decomposition.  
% Taking the closure of the globes \( \set{\dglobe{0}, \dglobe{1}, \ldots} \) under the pasting operations, one obtain a certain family of complexes, let us call them \( \underline{\Theta} \), a typical instance of is given by
% \begin{center}
%     \begin{tikzcd}
%         \bullet && \bullet && \bullet
%         \arrow[""{name=0, anchor=center, inner sep=0}, from=1-1, to=1-3]
%         \arrow[""{name=1, anchor=center, inner sep=0}, curve={height=-24pt}, from=1-1, to=1-3]
%         \arrow[""{name=2, anchor=center, inner sep=0}, curve={height=24pt}, from=1-1, to=1-3]
%         \arrow[""{name=3, anchor=center, inner sep=0}, curve={height=24pt}, from=1-3, to=1-5]
%         \arrow[""{name=4, anchor=center, inner sep=0}, curve={height=-24pt}, from=1-3, to=1-5]
%         \arrow[""{name=5, anchor=center, inner sep=0}, from=1-3, to=1-5]
%         \arrow["x", between={0.2}{0.8}, Rightarrow, from=2, to=0]
%         \arrow["y", between={0.2}{0.8}, Rightarrow, from=0, to=1]
%         \arrow["{x'}"', between={0.2}{0.8}, Rightarrow, from=3, to=5]
%         \arrow["{y'}"', between={0.2}{0.8}, Rightarrow, from=5, to=4]
%     \end{tikzcd}
% \end{center}
% It so happens that this directed CW complex can be described equivalently by the pastings
% \begin{equation*}
%     (x \cp{0} x') \cp{1} (y \cp{0} y') \;\text{ and }\; (x \cp{1} y) \cp{0} (x' \cp{1} y'),
% \end{equation*}
% where \( x, x', y \) and \( y' \) are copies of the 2-globe.
% That is, there is a directed cellular isomorphism
% \begin{equation*}
%     (x \cp{0} x') \cp{1} (y \cp{0} y') \stackrel{\xi}{\cong} (x \cp{1} y) \cp{0} (x' \cp{1} y'),
% \end{equation*} 
% given by the universal property of the pasting square.
% Hence the exchange law. 
% It turns out that the family consisting of the directed cellular isomorphisms representing the unitality, associativity, the exchange laws (in all of the possible dimensions) generates the whole family of directed cellular isomorphisms in \( \underline{Theta} \).
% This suggest once again that the axioms     

% In this topological setting, the composition along the \( k \)\nbd boundary is embodied by the \emph{pasting along the \( k \)\nbd boundary}. 
% The \( n \)\nbd globe \( \dglobe{n} \) comes equipped, for each \( k \geq 0 \) and \( \a \in \set{-, +} \), with a subcomplex \( \bd{k}{\a} \colon \dglobe{k} \incl \dglobe{n} \), representing the \( k \)\nbd source or \( k \)\nbd target map.   
% Then, for \( k \le n, m \), one defines the pasting of the \( n \)\nbd globe and the \( m \)\nbd globe along the \( k \)\nbd boundary as the (directed) regular CW complex \( \dglobe{n} \cp{k} \dglobe{m} \), given by the pushout 
% \begin{equation*}
%     \begin{tikzcd}
%         {\dglobe k} & {\dglobe m} \\
%         {\dglobe n} & {\dglobe{n} \cp{k} \dglobe{m}}
%         \arrow[""{name=0, anchor=center, inner sep=0}, "{\bd{k}{-}}", hook, from=1-1, to=1-2]
%         \arrow["{\bd{k}{+}}"', hook', from=1-1, to=2-1]
%         \arrow[from=1-2, to=2-2]
%         \arrow[from=2-1, to=2-2]
%         \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
%     \end{tikzcd}
% \end{equation*}
% in topological spaces.


% \begin{center}
%     \begin{tikzcd}
%         \bullet & \bullet & \bullet & \bullet \\
%         \bullet & \bullet & \bullet & \bullet
%         \arrow[""{name=0, anchor=center, inner sep=0}, from=1-1, to=1-2]
%         \arrow[""{name=1, anchor=center, inner sep=0}, curve={height=-12pt}, from=1-1, to=1-2]
%         \arrow["{(0')}", squiggly, no head, from=1-2, to=1-3]
%         \arrow[""{name=2, anchor=center, inner sep=0}, curve={height=-12pt}, from=1-3, to=1-4]
%         \arrow[""{name=3, anchor=center, inner sep=0}, from=1-3, to=1-4]
%         \arrow[""{name=4, anchor=center, inner sep=0}, from=2-1, to=2-2]
%         \arrow[""{name=5, anchor=center, inner sep=0}, curve={height=12pt}, from=2-1, to=2-2]
%         \arrow["{(0)}", squiggly, no head, from=2-2, to=2-3]
%         \arrow[""{name=6, anchor=center, inner sep=0}, from=2-3, to=2-4]
%         \arrow[""{name=7, anchor=center, inner sep=0}, curve={height=12pt}, from=2-3, to=2-4]
%         \arrow[between={0.2}{0.8}, Rightarrow, from=0, to=1]
%         \arrow["{(1)}"', between={0.2}{0.8}, squiggly, no head, from=0, to=4]
%         \arrow[between={0.2}{0.8}, Rightarrow, from=3, to=2]
%         \arrow["{(1')}", between={0.2}{0.8}, squiggly, no head, from=3, to=6]
%         \arrow[between={0.2}{0.8}, Rightarrow, from=5, to=4]
%         \arrow[between={0.2}{0.8}, Rightarrow, from=7, to=6]
%     \end{tikzcd}
% \end{center}
% Of course that \emph{pasting} along \( (0) \) and \( (0') \), then \( (1) \) and \( (1') \) will produce the same result as pasting along \( (1) \) and \( (1') \), then \( (0) \) (or \( (0') \)).
% How to make it formal?
% One way is to combinatorial complexes\dots 
% which it can be composed with other globular cells having the same \( k \)\nbd target and \( k \)\nbd source respectively. 


%% old diamond

    % \( (D_i )_{i = 1}^r \)
    % \begin{center}
    %     \begin{tikzcd}
    %         & {x_i} \\
    %         {y_i} && {y'_i} & {0 \le i \le r } \\
    %         & {z_i}
    %         \arrow[no head, from=1-2, to=2-1]
    %         \arrow[no head, from=1-2, to=2-3]
    %         \arrow[no head, from=2-1, to=3-2]
    %         \arrow[no head, from=2-3, to=3-2]
    %     \end{tikzcd}
    % \end{center}
    % transforming the left chain to the right chain.

        % Then we have in the covering diagram of \( \augm{U} \) 
    % \begin{center}
    %     \begin{tikzcd}
    %         & u \\
    %         {k_{n - 1}} && {u_{n - 1}} \\
    %         {k_0} && {u_0} \\
    %         & \bot.
    %         \arrow[no head, from=1-2, to=2-1]
    %         \arrow[no head, from=1-2, to=2-3]
    %         \arrow[dashed, no head, from=2-1, to=3-1]
    %         \arrow[dashed, no head, from=2-3, to=3-3]
    %         \arrow[no head, from=3-1, to=4-2]
    %         \arrow[from=3-3, to=4-2]
    %     \end{tikzcd}
    % \end{center}


% \begin{cor} \label{cor:diagrams_are_dense} 
%     Let \( C \) be a stricter \( \omega \)\nbd category.
%     Then the canonical strict functor
%     \begin{equation*}
%         \phi \colon \colim_{u \in \Dgm(C)} \molecin{U} \to C,t
%     \end{equation*}
%     is an isomorphism.
%     That is, the category \( \omegaMol \) is dense in \( \somegaCat \).
% \end{cor}
% \begin{proof}
%     Follows from the density formula for presheaves and Proposition \ref{prop:stricter_cat_are_local_presheaves}.
% \end{proof}

    % Recall from \cite[Lemma 7.2.8]{hadzihasanovic2024combinatorics} that the Gray product preserves pushout of inclusions of regular directed complexes.
    % Thus the square is a pushout if and only if for all \( x \in P \), the square
    % \begin{center}
    %     \begin{tikzcd}
    %         {\molecin{(\imel{P}{x} \gray \bd{}{}U)}} & {\molecin{(\imel{P}{x} \gray U)}} \\
    %         {\molecin{(\imel{P}{x} \gray \bd{}{}V)}} & {\molecin{(\imel{P}{x} \gray V)}}
    %         \arrow[from=1-1, to=1-2]
    %         \arrow["{\molecin{(\restr{\imel{P}{x} \gray s}{\bd{}{}U})}}"', from=1-1, to=2-1]
    %         \arrow["{{\molecin{\imel{P}{x} \gray s}}}", from=1-2, to=2-2]
    %         \arrow[from=2-1, to=2-2]
    %     \end{tikzcd}
    % \end{center}
    % is a pushout.
    % We prove the statement by induction on \( n \eqdef \dim P \).
    % If \( n = 0 \), this is the content of Corollary \ref{cor:pushout_principal_cell}.
    % Inductively, let \( n > 0 \) and \( x \in \gr{n}{P} \).
    % Let \( W \eqdef \imel{P}{x} \).
    % By Corollary \ref{cor:pushout_principal_cell} on \( W \gray s  \) and the pasting law for pushouts, it is enough to show that 
    % \begin{center}
    %     \begin{tikzcd}
    %         {\molecin{(W \gray \bd{}{} U)}} & {\molecin{(\bd{}{}(W \gray U))}} \\
    %         {\molecin{(W \gray \bd{}{} V)}} & {\molecin{(\bd{}{} (W \gray V))}}
    %         \arrow[from=1-1, to=1-2]
    %         \arrow[from=1-1, to=2-1]
    %         \arrow[from=1-2, to=2-2]
    %         \arrow[from=2-1, to=2-2]
    %     \end{tikzcd}
    % \end{center}
    % is a pushout.
    % Since 
    % \begin{equation*}
    %     \bd{}{}(W \gray U) = (W \gray \bd{}{} U) \cup (\bd{}{} W \gray U),\text{ and } \bd{}{}(W \gray V) = (W \gray \bd{}{} V) \cup (\bd{}{} W \gray V),
    % \end{equation*}
    % we conclude by Corollary \ref{cor:molecin_preserves_pushout_inclusions}, the inductive hypothesis on \( (\bd{}{} W) \gray s \), and a double application of the pasting law for pushouts. 


% \begin{thm} \label{thm:folk_model_structure}
%     There exists a model structure, called the \emph{folk model structure}, on \( \omegaCat \) such that:
%     \begin{enumerate}
%         \item every strict \( \omega \)\nbd categories is fibrant;
%         \item cofibrations are the retract of relative polygraphs. 
%     \end{enumerate} 
% \end{thm}
% \begin{proof} 
%     See \cite{lafont2010folk}.
% \end{proof}


% \begin{thm} \label{thm:folk_model_structure_on_stricter}
%     There is a cofibrantely generated model structure on the category \( \somegaCat \), called the \emph{folk model structure}, where:
%     \begin{enumerate}
%         \item every \( \omega \)\nbd categories is fibrant;
%         \item cofibration are the retracts of relative stricter polygraphs;
%     \end{enumerate}
%     Furthermore, this model structure is right transferred from the folk model structure on \( \omegaCat \) along the adjunction 
%     \begin{center}
%         \begin{tikzcd}
%             \somegaCat & \omegaCat,
%             \arrow[""{name=0, anchor=center, inner sep=0}, "\iota"', curve={height=12pt}, hook, from=1-1, to=1-2]
%             \arrow[""{name=1, anchor=center, inner sep=0}, "\rcs"', curve={height=12pt}, from=1-2, to=1-1]
%             \arrow["\dashv"{anchor=center, rotate=-90}, draw=none, from=1, to=0]
%         \end{tikzcd}
%     \end{center}
%     which is in particular a Quillen pair.
% \end{thm}
% \begin{proof}
%     This is a direct application of \cite[Proposition 21.3.2]{ara2025polygraphs} with Remark \ref{rmk:strict_stricter_same_cylinders} and Lemma \ref{lem:reflection_of_polygraphs_are_stricter_polygraphs}.
% \end{proof}

% \begin{rmk} 
%     By Corollary \ref{cor:pushout_principal_cell}, the set
%     \begin{equation*}
%         \Icof \eqdef \set{\molecin{\bd{}{}U} \incl \molecin{U} \mid U \text{ atom}}
%     \end{equation*}
%     is a generating set of cofibrations for the folk model structure on \( \somegaCat \).
% \end{rmk}

% \begin{dfn} [Diagrammatic nerve]
%     The \emph{diagrammatic nerve} is the right adjoint \( \N{} \) to the functor \( \molecin{-} \).
% \end{dfn}


\begin{dfn} [Pasting in a stricter \( \omega \)\nbd category]
    Let \( C \) be a stricter \( \omega \)\nbd category, consider two pasting diagrams \( \F \colon \molecin{U} \to C \), \( \G \colon \molecin{V} \to C \), and \( k \geq 0 \) such that \( \bd{k}{+} \F = \bd{k}{-} \G \).
    Then we write \( \F \cp{k} \G \colon \molecin{(U \cp{k} V)} \to C \) for the strict functor determined by the universal properties of pushout given by Corollary \ref{cor:molecin_preserves_pushout_inclusions}.
    More generally, if a generalised pasting \( U \gencp{k} V \) given by a span \( (i \colon U \cap V \incl U, j \colon U \cap V \incl V) \) is defined and such that \( \F \after \molecin{i} = \G \after \molecin{j} \), we write \( \F \gencp{k} \G \) for the strict functor determined by universal property of the pushout.
    If the generalised pasting is given by a pasting at a submolecules \( U \cpsub{\iota} V \) or \( V \subcp{\iota} V \), we write accordingly \( \F \cpsub{\iota} \G \) and \( \G \subcp{\iota} \F \).
\end{dfn}

\begin{lem} \label{lem:subdivision_of_unitors}
    Let \( s \colon U \sd V \) be a subdivision of molecules with formal dual \( c \colon V \to U \), and \( K \subseteq U \) be a closed subset of \( U \).
    Then the formal dual \( \arr \pcyl K s \colon \arr \pcyl K U \sd \arr \pcyl{s(K)} V \) of the order-preserving function \( \arr \times_K c \colon \arr \times_{s(K)} V \to \arr \times_K U \) is a subdivision of partial Gray cylinders.
\end{lem}
\begin{proof}
    Let \( x \in \arr \pcyl K U \), call \( V_x \eqdef s(\imel{U}{x}) \), \( K_x \eqdef \imel{U}{x} \cap K \), and \( c_x \) the restriction of \( c \) to \( V_x \)
    Then \( (\arr \pcyl K s)\imel{U}{x} \) is isomorphic to \( \arr \pcyl{s(K_x)} V_x \), which is a molecule.
    Now let \( q_V \colon \arr \times V_x \surj \arr \times_{s(K_x)} V_x  \) and \( q_U \colon \arr \times \imel{U}{x} \surj \arr \times_{K_x} \imel{U}{x} \) be the quotient maps.
    Then we have a commutative diagram
    \begin{center}
        \begin{tikzcd}
            {\arr \times \imel{U}{x}} & {\arr \times_{K_x} \imel{U}{x}.} \\
            {\arr \times V_x} & {\arr \times_{s(K_x)} V_x}
            \arrow["{{q_U}}", two heads, from=1-1, to=1-2]
            \arrow["{{\arr \times c_x}}", from=2-1, to=1-1]
            \arrow["{{q_V}}"', two heads, from=2-1, to=2-2]
            \arrow["{{\arr \times_{K_x} c_x}}"', from=2-2, to=1-2]
        \end{tikzcd}
    \end{center}
    By \cite[Proposition 7.2.21]{hadzihasanovic2024combinatorics}, the formal dual of \( \arr \times c_x \) is a subdivision.
    By inspection, for all \( k \in \mathbb{N} \) and \( \a \in \set{-, +} \), we have
    \begin{equation*}
        q_V(\bd{k}{\a} (\arr \gray V_x)) = \bd{k}{\a} (\arr \pcyl{s(K_x)} V_x) \text{ and } q_U(\bd{k}{\a} (\arr \gray \imel{U}{x})) = \bd{k}{\a} (\arr \pcyl{K_x} \imel{U}{x}),
    \end{equation*}
    which is enough to conclude. 
\end{proof}