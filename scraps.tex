\begin{lem} \label{lem:local_wrt_directed_complexes}
    Let \( C \) be a stricter \( n \)\nbd category and \( P \) be a \( n \)\nbd regular directed complex.
    Then \( C \) is local with respect to the canonical strict functor 
    \begin{equation*}
        s_P \colon \colim_{x \in P} \molecin{\imel{P}{x}} \to \molecin{P}.
    \end{equation*}
\end{lem}
\begin{proof}
    Consider a strict functor \( \F \colon \colim_{x \in P} \molecin{\imel{P}{x}} \to C \), and for \( x \in P \), denote by \( \F_x \) the restriction of \( \F \) along \( \molecin{\imel{P}{X}} \to \colim_{x \in P} \molecin{\imel{P}{x}} \).
    We define a strict functor \( \G \colon \molecin{P} \to C \) such that \( \G \after s_P = \F \).
    Let \( u \colon U \to P \) be a morphism with \( U \) an atom.
    Then \( u = \mapel{x} \) for some \( x \in P \), hence we must necessarily let \( \G(u) \eqdef \F_x(\idd{}) \).
    Since \( \atomin{P} \) is a basis for \( \molecin{P} \), this assignment uniquely determine \( \G \).
    We need to show that this indeed makes \( \G \) a strict functor.
    Let \( w \colon W \to P \) be a pasting diagram.
    We show that \( \G(w) \) does is independent on the decomposition of \( w \) into pasting of cells. 
    We proceed by induction on submolecules, the base case being evident.
    Inductively, suppose that \( \G(w') \) is well defined for all proper subdiagrams \( w' \) of \( w \), and consider a proper decomposition \( w = w_1 \cp{k} w_2 \).
    Then we have a strict functor \( (\G_1, \G_2) \colon \molecin{W_1} \cup \molecin{W_2} \to C \), where \( \G_i \) is the restriction of \( \G \) along \( \molecin{w_i} \), which is well defined by inductive hypothesis. 
    Since \( C \) is stricter, \( (\G_1, \G_2) \) extends to a strict functor \( \G' \colon \molecin{W} \to C \) with the property that \( \G'(u) = \G(u) \) for all \( u \in \atomin{P} \).
    This proved that \( \G \) is well defined, and concludes the proof. 
\end{proof}


\begin{prop} \label{prop:density_of_pasting_diagram}
    Let \( C \) be a stricter \( \omega \)\nbd category.
    Then the canonical strict functor
    \begin{equation*}
        \phi \colon \colim_{u \in \Dgm(C)} \molecin{U} \to C,
    \end{equation*}
    is an isomorphism.
\end{prop}
\begin{proof}
    We show that \( C \) has the universal property of the colimit. 
    Consider a cone \( \set{\F_u \colon \molecin{U} \to D}_{u \in \Dgm(C)} \) for some stricter \( \omega \)\nbd category \( D \).
    We define a strict functor \( \F \colon C \to D \).
    Each globular cell \( c \) of \( C \) is classifies by a pasting diagram \( u \colon O^n \to C \), and therefore we must let \( \F(c) \eqdef \pcell{\F_u} \).
    This shows the uniqueness of the universal property.
    Let \( U \) be a molecule. 
    We must show that the diagram
    \begin{center}
        \begin{tikzcd}
            {\molecin{U}} \\
            C & D
            \arrow["u"', from=1-1, to=2-1]
            \arrow["{\F_u}", from=1-1, to=2-2]
            \arrow["\F"', from=2-1, to=2-2]
        \end{tikzcd}
    \end{center}
    commute.
    Let \( w \colon W \to U \) be a morphism with \( \dim w = n \).
    Then \( w \) is classified by a pasting diagram \( w' \colon \globe{n} \to \molecin{U} \), and by definition, \( \F \after u \after w' = \F_u \after w' \).
    Passing to the principal cells, we get that \( (\F \after u)(w) = \F_u(w) \).
    This shows that the diagram commutes.
    Now we need to proves that \( \F \) is indeed a strict functor, which is done by using the fact that \( C \) is stricter, the commutation of the previous diagram for all molecules \( U \), together with the strict functors
    \begin{equation*}
        \molecin{(\bd{k}{\a} \dglobe{n})} \to \molecin{\dglobe{n}}
    \end{equation*}
    classifying the morphism \( \bd{k}{\a} \dglobe{n} \to \dglobe{n} \), and  
    \begin{equation*}
        \molecin{\dglobe{n}} \to \molecin{(\dglobe{n} \cp{k} \dglobe{n})},
    \end{equation*}
    classifying the principal cell of \( \molecin{(\dglobe{n} \cp{k} \dglobe{n})} \).
    This concludes the proof.
\end{proof}

\begin{rmk} \label{rmk:thetas_are_dense}
    As it is the case for strict \( \omega \)\nbd categories, the previous result is still valid if one let the colimit run over pasting diagrams \( u \colon \molecin{U} \to C \), where \( U \) is a ``theta'', that is, a pasting of directed globes.
\end{rmk}


%% old folk model structure



% \begin{lem} \label{lem:j_n_weak_equivalence_cofibration}
%     Let \( n \geq 0 \).
%     Then \( j_n \) is both a stricter cofibration and an \( \omega \)\nbd equivalence.
% \end{lem}
% \begin{proof}
%     The strict functor \( j_n \) is a stricter cofibration as composite of two stricter cofibrations.
%     Furthermore, \( p \after j_n = \idd{\globe{n}} \).
%     By \cite[Proposition 20.1.17 and 20.1.13 ]{ara2025polygraphs} (which hold more generally for strict functors of composition structures), \( j_n \) is an \( \omega \)\nbd equivalence.
% \end{proof}

    % A globular \( n \)\nbd cell \( u \) in \( \Gamma(C) \) is therefore a strict functor \( u \colon \molec{(\arr \gray \dglobe{n})} \to C \), and we say that \( u \) is a \emph{reversible cylinder} if \( \pcell{u} \), as well as the principal cells of 
    % \begin{equation*}
    %    u \after \molecin{(\arr \gray \iota^\a_k)} \colon \molecin{(\arr \gray \dglobe{k})} \to C
    % \end{equation*}
    % are reversible, for each \( k \geq 0 \) and \( \a \in \set{-, +} \), where \( \iota^\a_k \) is the strict functor
    % \begin{equation*}
    %     \iota^\a_k \colon \molecin{(\bd{k}{\a} \dglobe{n})} \to \molecin{\dglobe{n}}.
    % \end{equation*} 
    % We then define the \emph{stricter \( \omega \)\nbd category of reversible cylinder} \( \rGamma(C) \) to be the stricter \( \omega \)\nbd category \( \rGamma(C) \subseteq \Gamma(C) \) on globular cells classifying reversible cylinders.

    % \begin{prop} \label{lem:stricter_cof_and_weak_stable_under_pushout}
%     The class of strict functors between stricter \( \omega \)\nbd categories that are both \( \omega \)\nbd equivalences and stricter cofibrations is closed under pushouts (in \( \somegaCat \)).
% \end{prop}
% \begin{proof}
%     Similar to the proof of \cite[Theorem 20.5.6]{ara2025polygraphs}, replacing ``cofibration'' with ``stricter cofibrations''.
% \end{proof}

\begin{dfn} [Relative stricter polygraph and stricter cofibration]
    Let \( f \colon C \to D \) be a strict functor of stricter \( \omega \)\nbd categories.
    We say that \( f \) is a \emph{relative stricter polygraph} if \( f \) can be written as a transfinite composition of pushouts (in \( \somegaCat \)) of elements of \( \Icof \).
    A retract of a relative stricter polygraph is called a \emph{stricter cofibration}.
\end{dfn}


% old and ugly rlp

% \begin{proof}
%     Let \( h \colon v \celto \compos{v} \) be a weak composite of \( v \), and \( z \colon f(u) \celto f(\compos{v}) \) be a weak composite of \( w \cp{} h \).
%     Since \( f \) has the right lifting property against \( \Jcomp \), \( z = f(z') \) for some equivalences \( z' \colon u \celto v' \).


%     Let \( h \colon f(v) \celto \compos{f(v)} \) be a weak composite, and \( z \colon f(u) \celto \compos{f(v)} \) be a weak composite of \( w \cp{} h \).
%     By Theorem \ref{thm:main_equivalence}, \( z \) is an equivalence, thus extends to \( \td{z} \colon f(u) \simeq \compos{f(v)} \).
%     By assumption, \( z = f(z') \) for some equivalence \( z \colon u \celto v' \).
%     Now, \( h \colon f(v) \)
% \end{proof}

% \begin{prop} \label{prop:relative_rlp_localisation}
%     Let \( f \colon Y \to W \) be a functor of \( (\infty, \infty) \)\nbd categories with the right lifting property against \( \Jcomp \), let \( (X, A) \) be a marked diagrammatic set, and consider lifting problem of the form
%     \begin{center}
%         \begin{tikzcd}
%             X & Y \\
%             {\loc X A} & W.
%             \arrow["u", from=1-1, to=1-2]
%             \arrow[from=1-1, to=2-1]
%             \arrow["f", from=1-2, to=2-2]
%             \arrow["{\td u}"', from=2-1, to=2-2]
%         \end{tikzcd}
%     \end{center}
%     Then the lifting problem admits a solution if and only if for each cell \( a \in A \), \( u(a) \) is an equivalence in \( Y \).
% \end{prop}
% \begin{proof}
%     If the lifting problem has a solution, clearly each of the \( u(a) \) is an equivalence in \( Y \).
%     Conversely, \( \loc{X}{A} \) is the colimit of the the sequence \( \order{n}{X} \incl \order{n + 1}{X} \) starting with \( \order{0}{X} \eqdef X \).
%     We let \( \iota_n \colon \order{n}{X}  \incl \loc{X}{A} \) be the canonical inclusion.
%     We define a lift \( \td{v} \colon \loc{X}{A} \to Y \) by successive extension along \( \order{n}{X} \incl \order{n + 1}{X} \), starting with \( \order{0}{v} \eqdef u \), and with the property that for all \( a \in \order{n}{A} \), \( \order{n}{v}(a) \) is an equivalence in \( Y \) and \( f \after \order{n}{c} = \td{u} \after \iota_n \).
%     Let \( n > 0 \) and consider \( a \in \order{n - 1}{A} \).
%     By inductive hypothesis, \( b \eqdef \order{n - 1}{v}(a) \colon c \celto d \) has left and right inverse \( b^L, b^R \colon d \celto c \), witnessed by the equivalences
%     \begin{equation*}
%         z \colon b \cp{} b^L \celto \un(c),\quad\quad h \colon \un(d) \celto b^R \cp{} b \celto \un(d).
%     \end{equation*}
%     By construction, \( f(b) \colon f(c) \celto f(d) \), which is equal to \( (\td{u} \after \iota_n)(a) \), has left and right inverses given by the cells \( f(b)^L \) and \( f(b)^R \), witnessed by the equivalences
%     \begin{equation*}
%         \hcyl{L}(f(b)) \colon f(b) \cp{} f(b)^L \celto \un f(c),\quad\quad \hcyl{R}(f(b)) \colon \un f(d) \celto f(b)^R \cp{} f(b).
%     \end{equation*}
%     % By Theorem \ref{thm:main_equivalence}, there are equivalences \( h^L \colon f(b^L) \celto f(b)^L \) and \( h^R \colon f(b^R) \celto f(b)^R \) in \( Y \), which, up to passing to a weak composites, we may assume to be cells.
%     Now consider the equations in \( W \)
%     \begin{equation*}
%         x \cpsub{f(b^L)} f(z) \qeq \hcyl{L}(f(b)^L) 
%     \end{equation*}
%     has a solution

%     Since \( f \) has the right lifting property against \( \Jcomp \), \( h^L = f(z^L) \) and \( h^R = f(z^R) \) for some equivalences \( z^L \colon b^L \celto b_0^L \) and \( z^R \colon b^R \celto b_0^R \).
%     Now
%     In particular, we may define
%     \begin{equation*}
%         \order{n}{v}(a^L) \eqdef b^L_0\quad\text{ and }\quad \order{n}{v}(b^L) \eqdef b^R_0.
%     \end{equation*}
%     Now we have the equivalences \( h \colon f(b) \cp{k} f(b)^L \celto \un f(c) \) and \( z \colon \un f(d) \celto f(b)^L \)
% \end{proof}

% \begin{rmk}
%     By \cite[Proposition 3.7]{chanavat2024model} an \( (\infty, \infty) \)\nbd category \( X \), a cell \( u \colon U \to X \) is an equivalence if an only if it extends to some \( \td u \colon \selfloc{U} \to X \).
%     Thus, a diagrammatic set \( X \) is an \( (\infty, n) \)\nbd category if and only if it has the right lifting property against \( \Jcomp \cup \Jn{n} \).
% \end{rmk}


% \begin{lem} \label{lem:isofib_rlp_double_walking}
%     Let \( n \in \mathbb{N} \cup \set{\infty} \), \( f \colon X \to Y \) be a functor of \( (\infty, n) \)\nbd categories with the right lifting property against \( \Jcomp \), and \( U \) be an atom of dimension \( > 0 \).
%     Then \( f \) has the right lifting property against 
%     \begin{equation*}
%         \selfloc{U} \incl \Loc (\selfloc{U}, \dgn \selfloc{U} \cup \set{U \incl \selfloc{U}}).
%     \end{equation*}
% \end{lem}
% \begin{proof}
%     Call \( \selfloc{U}^2 \eqdef \Loc (\selfloc{U}, \dgn \selfloc{U} \cup \set{U \incl \selfloc{U}}) \), and consider a lifting problem
%     \begin{center}
%         \begin{tikzcd}
%             {\selfloc{U}} & X \\
%             {\selfloc{U}^2} & Y.
%             \arrow["{\tilde u}", from=1-1, to=1-2]
%             \arrow[from=1-1, to=2-1]
%             \arrow["f", from=1-2, to=2-2]
%             \arrow["s"', from=2-1, to=2-2]
%         \end{tikzcd}
%     \end{center}
%     Then \( s \) classifies the extension \( f(\td{u}) \colon \selfloc{U} \to X \) of \( f(u) \), together with another extension \( \td{v} \colon \selfloc{U} \to X \).
%     Let \( u \colon a \celto b \) be the type of \( u \).
%     We let \( w \eqdef u \), and construct an extension \( \td{w} \colon \td{U} \to X \) of \( w \) such that \( f(\td{w}) = \td{v} \).
%     We proceed by induction on the construction of the localisation: we do the base case and leave the inductive step, which proceed along the same line, to the reader.
%     Let \( f(w)^L \) and \( v^L \) be the left inverses of \( f(w) \) attached at the first step of the localisation.
%     By Theorem \ref{thm:main_equivalence}, \( \td{e} \colon f(u)^L \simeq v^L \), where \( h \) is can be taken to be a cell, since \( Y \) is an \( (\infty, n) \)\nbd category.
%     Since \( f \) has the right lifting property against \( \Jcomp \), \( \td{e} = f(\td{e}') \), in particular \( v^L = f(w^L) \).
%     Then, one attaches \( \hinv{L}(v) \colon v \cp{} v^L \celto \un(f(a)) \) and \( \hinv{R} \colon \un(f(b)) \celto v^R \cp{} v \).
%     Since \( v \cp{} v^L = f(u \cp{} w^L) \) and \( \un(f(b)) = f(\un(b)) \), we have \( \hinv{L}(v) = f(\hinv{L}(w)) \) and \( \hinv{R}(v) = f(\hinv{r}(w)) \) for some equivalence \( \hinv{L}(w) \colon w \cp{} w^L \celto a' \) and \( \hinv{R}(w) \colon \un(b) \celto w^R \cp{} w \).
%     \cccom{TODO: a' is not necessarily a unit, fix that, or not?}
% \end{proof}

% \begin{lem} \label{lem:isofib_rlp_dual_comp}
%     Let \( n \in \mathbb{N} \cup \set{\infty} \), \( f \colon X \to Y \) be a functor of \( (\infty, n) \)\nbd categories with the right lifting property against \( \Jcomp \), and \( U \) be a round molecule.
%     Then \( f \) has the right lifting property against the inclusion \( U \incl \compos{U} \simeq U \).
% \end{lem}
% \begin{proof}
%     Consider a lifting problem
%     \begin{center}
%         \begin{tikzcd}
%             U & X \\
%             {\compos{U} \simeq U} & Y
%             \arrow["u", from=1-1, to=1-2]
%             \arrow[from=1-1, to=2-1]
%             \arrow["f", from=1-2, to=2-2]
%             \arrow["{\td h}"', from=2-1, to=2-2]
%         \end{tikzcd}
%     \end{center}
%     Consider a lift \( \td z \colon \compos{U}\simeq U \to X \) making the upper triangle commute.
%     Call \( V \eqdef \compos{U} \celto U \).
%     Then too solve the previous lifting problem, it is enough to solve
%     \begin{center}
%         \begin{tikzcd}
%             {\selfloc V} & X \\
%             {\Loc (\selfloc V,\set{\top_V})} & Y
%             \arrow["{\td z}", from=1-1, to=1-2]
%             \arrow[from=1-1, to=2-1]
%             \arrow["f", from=1-2, to=2-2]
%             \arrow["{\td h \cup f(\td z)}"', from=2-1, to=2-2]
%         \end{tikzcd}
%     \end{center}
%     which is possible by Lemma \ref{lem:isofib_rlp_double_walking}.
% \end{proof}

% \begin{lem} \label{lem:rlp_localised_horn_iff_rlp_weak_composite}
%     Let \( n \in \mathbb{N} \cup \set{\infty} \), and \( f \colon X \to Y \) be a functor of \( (\infty, n) \)\nbd categories.
%     The following are equivalent.
%     \begin{enumerate}
%         \item \( f \) has the right lifting property against \( \Loc \Jhorn \);
%         \item \( f \) has the right lifting property against \( \Jcomp \); 
%     \end{enumerate}
% \end{lem}
% \begin{proof}
%     The second condition is clearly necessary since \( \Jcomp \subseteq \Loc \Jhorn \).
%     Conversely, suppose that \( f \) has the right lifting property against \( \Loc \Jhorn \), and consider a marked horn \( \lambda^x_U \colon (\Lambda^x_U, B) \to (U, A) \).
%     Suppose without loss if generality that \( x \in \bd{}{-} U \).
%     Suppose also that \( x \notin A \), the proof in the other case follows similar lines.
%     Recall from \cite[Comment 3.13]{chanavat2024model} that a morphism \( s \colon \Loc (\Lambda^x_U, B) \to X \) classifying in \( X \) an equation \( \fun{E}x \qeq v \) in the indeterminate \( x \), where \( v \eqdef \restr{s}{\bd{}{+}U} \), and \( \fun{E} \) is a weakly invertible context in the sense of \cite[3.12]{chanavat2024equivalences}.
%     An extension of \( s \) along \( \lambda^x_U \) then classifies a solution \( u \), witnessed by \( \tilde{h} \colon \fun{E}u \simeq v \). 
%     Thus, by \cite[Lemma 5.10]{chanavat2024equivalences}, and passing to weak composites, all \( (\infty, n) \)\nbd categories have the right lifting property against \( \Loc \Jhorn \).
%     Now consider a lifting problem
%     \begin{center}
%         \begin{tikzcd}
%             {\Loc (\Lambda^x_U, B)} & X \\
%             {\Loc (U, A)} & Y
%             \arrow["s", from=1-1, to=1-2]
%             \arrow[from=1-1, to=2-1]
%             \arrow["f", from=1-2, to=2-2]
%             \arrow["{\tilde h}"', from=2-1, to=2-2]
%         \end{tikzcd}
%     \end{center}
%     and choose a lift \( \tilde{h}' \colon \Loc (U, A) \to X \) making the upper triangle commute. 
%     Then, \( \tilde{h} \cup f(\tilde{h'}) \) classify another equation \( x' \cpsub{} f(\tilde{h}) \qeq \tilde{h} \) in \( Y \), which admits a solution \( \tilde{w} \colon u \simeq f(u') \), witnessed by \( \tilde{z} \colon \tilde{w} \cpsub{} f(\tilde{h}') \celto \tilde{h} \)
%     By Lemma \ref{lem:isofib_rlp_dual_comp}, \( \tilde{w} = f(\tilde{w'}) \) for \( w' \colon \hat{u} \simeq u' \).
%     In particular, \( f(\hat{u}) = u \).
%     Thus \( \tilde{z} \) has type \( f(\tilde{w'} \cpsub{} \tilde{h}') \simeq \tilde{h} \).
%     By assumption and Lemma \ref{lem:isofib_rlp_double_walking} twice, \( \tilde{z} = f(\tilde{z'}) \) for some \( \tilde{z'} \colon \tilde{w'} \cpsub{} \tilde{k} \).
%     In particular, \( \tilde{k} \) classifies another solution in \( X \) of the equation given by \( s \) and \( f(\tilde{k}) = \tilde{h} \).
%     Therefore, \( \tilde{k} \colon \Loc (U, A) \) is the desired lift.  
% \end{proof}


\begin{dfn}
    Let \( \iota \colon (X, A) \incl (Y, B) \) be an inclusion of marked diagrammatic sets, and \( u \colon (L, C) \to (X, B) \) be a morphisms of diagrammatic sets. 
    We write \( u \in_\iota A \) if \( u \) factors through \( \iota \), and \( u \notin_\iota A \) otherwise.
\end{dfn}

\begin{lem} \label{lrm:relative_small_object_argument}\ccnote{define relative cell complex, change def of relative polygraph to relfect the definition}
    Let \( \iota \colon A \to X \) be an inclusion of diagrammatic sets, and \( J \) be a set of inclusions with the left lifting property against \( X \).
    Then there exists a factorisation of \( \iota \) into inclusions
    \begin{equation*}
        A \stackrel{j}{\incl} \order{\infty}{A} \incl X,
    \end{equation*}
    such that \( \order{\infty}{A} \) has the right lifting property against \( J \) and \( j \) is a relative \( J \)\nbd cell complex.
\end{lem}
\begin{proof}
    We construct \( \order{\infty}{A} \incl X \) by a transfinite induction of relative \( J \)\nbd cell complexes
    \begin{center}
        \begin{tikzcd}
            {A \eqdef \order{0}{A}} & {\order 1 A} & \ldots & {\order{n} A} & \ldots \\
            \\
            &&& X
            \arrow[hook, from=1-1, to=1-2]
            \arrow["{{\order 0 \iota \eqdef \iota}}"', curve={height=6pt}, hook, from=1-1, to=3-4]
            \arrow[hook, from=1-2, to=1-3]
            \arrow["{{\order 1 \iota}}"{description}, hook, from=1-2, to=3-4]
            \arrow[hook, from=1-3, to=1-4]
            \arrow[dashed, hook, from=1-3, to=3-4]
            \arrow[hook, from=1-4, to=1-5]
            \arrow["{{\order n \iota}}"{description}, hook, from=1-4, to=3-4]
        \end{tikzcd}
    \end{center}
    and such that \( \iota_n \) is an inclusion.
    The base case is \( (\order{0}{A}, \order{0}{\iota}) \eqdef (A, \iota) \).
    Let \( n > 0 \) and suppose inductively that \( \order{n - 1}{A} \) has been defined.
    Define \( \order{n}{S} \) by
    \begin{equation*}
        \coprod_{k \colon K \to L \in J} \set{(u \colon K \to \order{n - 1}{A}, v \colon L \to X) \mid v \after k = \order{n - 1}{\iota} \after u, v \notin_{\order{n - 1}{\iota}} \order{n - 1}{A} }.
    \end{equation*}
    Then define \( \order{n}{\iota} \colon \order{n}{A} \to X \) by the pushout
    \begin{center}
        \begin{tikzcd}
            {\coprod_{(k \colon K \to L, u, v) \in \order n S} K} & {\coprod_{(k \colon K \to L, u, v) \in \order n S} L} \\
            {\order{n - 1} A} & {\order n A} \\
            && X
            \arrow[""{name=0, anchor=center, inner sep=0}, "{\coprod k}", from=1-1, to=1-2]
            \arrow["{\coprod u}"', from=1-1, to=2-1]
            \arrow[from=1-2, to=2-2]
            \arrow["{\coprod v}", curve={height=-12pt}, from=1-2, to=3-3]
            \arrow[from=2-1, to=2-2]
            \arrow["{\order{n - 1} \iota}"{description}, curve={height=12pt}, hook, from=2-1, to=3-3]
            \arrow["{\order n \iota}"{description}, from=2-2, to=3-3]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
        \end{tikzcd}
    \end{center}
    We claim that \( \order{n}{\iota} \) is a monomorphism. 
    Inde
\end{proof}


%% cannot prove those results on strictification

% We recall that every surjective cartesian map \( p \colon U \to V \) of molecules factors uniquely into \( p = \ell \after f \) where \( \ell \) is a surjective morphism and \( f \) is a surjective final map.

% \begin{dfn} [Strict pasting diagram]
%     Let \( u \colon U \to X \) be a pasting diagram in a diagrammatic set. 
%     Then \( u \) factors uniquely as \( u = v \after \ell \after f \) where \( v \) is a non-degenerate pasting diagram, \( \ell \) is a surjective morphism and \( f \) is a surjective final map.
%     The \emph{strictification of \( u \)} is the diagram \( \s(u) \eqdef v \after \ell \).
%     We say that a diagram \( u \) is strict if \( u = \s(u) \).
% \end{dfn}

% \begin{lem}
    
% \end{lem}

% \begin{dfn} [Composition structure of strict pasting diagrams]
%     Let \( X \) be a diagrammatic set.
%     Then the \emph{composition structure of strict pasting diagrams of \( X \)} is the composition structure
%     \begin{equation*}
%         C \eqdef \set{u \in \Pd(X) \mid u \text{ strict}},
%     \end{equation*}
%     where, for \( k \geq 0 \), \( \a \in \set{-, +} \), \( \bd{k}{\a} \colon C \to C \) is the function \( u \mapsto \s(\bd{k}{\a} u) \)
% \end{dfn}

% \begin{prop} \label{prop:molecin_description}
%     Let \( X \) be a diagrammatic set.
% \end{prop}

\begin{rmk} \label{rmk:reflection_of_polygraph_is_stricter_polygraph}
    Since the functor \( \rcs \) is left adjoint, if a strict \( \omega \)\nbd category \( C \) is a polygraph in the traditional sense, then \( \rcs C \) is a stricter polygraph.
\end{rmk}


%% subdivide localisaiton

\begin{lem}
    Let \( X, Y \) be diagrammatic sets, \( \fun{F} \colon X \to Y \) be a strict functor, \( u \colon U \to X \) and \( v \colon V \to Y \) be cells, \( c \colon U \sd V \) be a subdivision such that \( \F \after \molecin{u} = \molecin{v} \after \molecin{c} \).
    Then there exists a strict functor \( \F' \colon \molecin{(\preloc{X}{u})} \to \molecin{(\preloc{Y}{v})} \) fitting in a pushout diagram
    \begin{center}
        \begin{tikzcd}
            {\molecin X} & {\molecin{(\preloc{X}{u})}} \\
            {\molecin Y} & {\molecin{(\preloc{Y}{v})}}
            \arrow[""{name=0, anchor=center, inner sep=0}, from=1-1, to=1-2]
            \arrow["\F", from=1-1, to=2-1]
            \arrow["{\F'}", from=1-2, to=2-2]
            \arrow[from=2-1, to=2-2]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
        \end{tikzcd}
    \end{center}
    where the horizontal strict functors are canonical.
\end{lem}
\begin{proof}
    To avoid overloading the notation, we avoid writing \( \molecin{-} \) in this proof.
    We then construct \( \F' \colon \preloc{X}{u} \to \preloc{Y}{v} \) in two steps.
    First we construct \( \F' \colon X' \to Y' \) by universal property
    \begin{center}
        \begin{tikzcd}
            {\bd{}{}U \coprod \bd{}{}U} & {U \coprod U} \\
            X & {X'} & {\bd{}{}V \coprod \bd{}{}V} & {V \coprod V} \\
            && Y & {Y'}
            \arrow[""{name=0, anchor=center, inner sep=0}, from=1-1, to=1-2]
            \arrow[from=1-1, to=2-1]
            \arrow[from=1-1, to=2-3]
            \arrow[dashed, from=1-2, to=2-2]
            \arrow["{c \coprod c}", from=1-2, to=2-4]
            \arrow[dashed, from=2-1, to=2-2]
            \arrow["\F"', from=2-1, to=3-3]
            \arrow["{\F'}", dashed, from=2-2, to=3-4]
            \arrow[""{name=1, anchor=center, inner sep=0}, from=2-3, to=2-4]
            \arrow[from=2-3, to=3-3]
            \arrow[from=2-4, to=3-4]
            \arrow[from=3-3, to=3-4]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=3-4, to=1]
        \end{tikzcd}
    \end{center}
    The top square is a pushout by Lemma \ref{lem:pushout_principal_cell}, thus so is the bottom one.
    \cccom{Really need some theory of subdivision}
\end{proof}


%%% counit 

\noindent We now investigate the counit of the adjunction \( \molecin{-} \dashv \N{} \).
% \begin{dfn}\ccnote{NO ClÃ©mence: nu is not a strict functor }
%     For any stricter \( \omega \)\nbd category \( C \) and atom \( U \), strict functors \( u \colon \molecin{U} \to C \) correspond naturally to cells \( u^\dagger \colon U \to \N{} C \).
%     By Corollary \ref{cor:molecin_polygraph_with_basis}, \( \molecin{\N{} C} \) is a stricter polygraph with basis
%     \begin{equation*}
%         \set{u \colon \molecin{U} \to C \mid u^\dagger \in \nd \N{}C}.
%     \end{equation*}
%     The counit \( \eps_C \colon \molecin{\N{}C} \to C \) is then defined on the basis by \( u \mapsto \pcell{u} \).
%     We let \( \nu_C \colon C \to \molecin{\N{} C} \) be the strict functor defined by sending a globular cell \( u \colon \globe{\dim u} \to C \) to \( \molecin{u^\dagger} \).
% \end{dfn}

% \begin{rmk}\label{rmk:nu_C_sends_to_basis}
%     The transpose of a globular cell \( u \colon \globe{\dim u} \to C \) is always non-degenerate.
%     Thus, by Corollary \ref{cor:molecin_polygraph_with_basis}, \( \nu_C \colon C \to \molecin{\N{} C} \) sends globular cells of \( C \) to elements of the basis of \( \molecin{\N{} C} \).
% \end{rmk}

% \begin{lem} \label{lem:eps_star_is_omega_eq}
%     Let \( C \) be a stricter \( \omega \)\nbd category.
%     Then \( \nu_C \) is an \( \omega \)\nbd equivalence. 
% \end{lem}
% \begin{proof}
%     Denote \( \nu \eqdef \nu_C \).
%     By Corollary \ref{cor:molecin_polygraph_with_basis}, the objects of \( \molecin{\N{} C} \) coincides with the \( 0 \)\nbd cells \( u \colon \pt \to \N{} C \).
%     Transposing, one sees that they corresponds in fact to the objects of \( C \), hence \( \nu \) is surjective on objects.
%     Let \( n > 0 \) and \( (c^-, c^+) \colon \bd{}{} \globe{n} \to C \) be a pair of parallel globular cells, and consider a globular cell \( u \colon \globe{n} \to \molecin{\N{}C} \) of type \( u \colon \nu(c^-) \gcelto \nu(c^+) \).
%     Since \( \molecin{\N{} C} \) the non-degenerate cells of \( \N{} C \) are a basis of \( \molecin{\N{} C} \) by Corollary \ref{cor:molecin_polygraph_with_basis}, we may show that \( u \sim \nu(v) \) for some globular cell \( v \colon c^- \gcelto c^+ \) in \( C \) by induction on the dimension, then the construction of \( u \).
%     We already established the case \( \dim u = 0 \).
%     Inductively, let \( n > 0 \).
%     Suppose first that \( u \) is an element of the basis, then necessarily \( u = \nu(\eps_C(u)) \).
%     Now suppose that \( u = u_1 \comp{k} u_2 \) for some \( k < n \), and \( u_i \colon u_i^- \gcelto u_i^+ \) for \( i \in \set{1, 2} \).
%     Suppose \( k < n - 1 \).
%     Let \( \a \in \set{-, +} \), then \( \nu(c^\a) = \bd{n - 1}{\a} u = u_1^\a \comp{k} u_2^\a \). 
%     By Remark \ref{rmk:nu_C_sends_to_basis}, this means that either \( \nu(c^\a) = u^\a_1 \) and \( u_2^\a = \nu(\bd{k}{+} c^\a) \), or \( \nu(c^\a) = u^\a_2 \) and \( u_1^\a = \nu(\bd{k}{-} c^\a) \).
%     In any case, we have for all \( i \in \set{1, 2} \) and \( \a \in \set{-, +} \), globular cells \( c^\a_i \) such that \( u_i \colon \nu(c_i^-) \gcelto \nu(c_i^+) \).
%     By inductive hypothesis, there exists both \( i \in \set{1, 2} \), globular cells \( v_i \colon c_i^- \gcelto c_i^+ \) such that \( u_i \sim \nu(v_i) \).
%     By Proposition \ref{prop:reversible_globular_cells}, \( u \sim \nu(v_1) \comp{k} \nu(v_2) = \nu(v_1 \comp{k} v_2 ) \).
%     Last, suppose that \( k = n - 1 \), so that \( u_1 \colon \nu(c^-) \gcelto w \) and \( u_2 \colon w \gcelto \nu(c^+) \).
%     Then, \( \dim w < n \) and either \( n = 1 \) and \( w \) is an object, or \( w \colon \nu(\bd{n - 2}{-} c^-) \gcelto \nu(\bd{n - 2}{+} c^-) \).
%     In any case, by inductive hypothesis on the dimension, we have a globular cell \( w' \colon \bd{n - 2}{-} c^- \gcelto \bd{n - 2}{+} c^- \)
%     \cccom{does not work unless one shows first that nu is a fibration, which it is not}
% \end{proof}

% \begin{thm} \label{thm:cofibrant_replacement_counit_infty}
%     Let \( C \) be a stricter \( \omega \)\nbd category.
%     Then the (derived) counit \( \eps_C \colon \molecin{\N{} C} \to C \) is an acyclic fibration in the folk model structure on stricter \( \omega \)\nbd categories.
% \end{thm}
% \begin{proof}\ccnote{very much false}
%     Notice that for all \( n \geq 0 \), a globular cell \( u \colon \globe{n} \to C \) of \( C \) is equivalent, by transposing along the adjunction \( \molecin{-} \dashv \N{} \), to a cell \( u^\dagger \colon \dglobe{n} \to \N{} C \).
%     Let \( n \geq 0 \) and consider a lifting problem of the form
%     \begin{center}
%         \begin{tikzcd}
%             {\bd{}{}\globe n} & {\molecin{\N{}C}} \\
%             {\globe n} & C
%             \arrow["{(v^-, v^+)}", from=1-1, to=1-2]
%             \arrow[from=1-1, to=2-1]
%             \arrow["\eps_C", from=1-2, to=2-2]
%             \arrow["u"', from=2-1, to=2-2]
%         \end{tikzcd}
%     \end{center}
%     We claim that \( \molecin{u^\dagger} \colon \globe{n} \to \molecin{\N{} C} \) solves the lifting problem. 
%     Indeed, \( u = \eps_C \after \molecin{u^\dagger} \) by adjunction.
%     Then for \( \a \in \set{-, +} \), 
%     \begin{equation*}
%         \bd{}{\a} (\molecin{u^\dagger}) = \molecin{(\bd{}{\a} u^\dagger)} = \molecin{(\bd{}{\a}u)^\dagger} = \molecin{(v^\a)^\dagger}.
%     \end{equation*}  
%     By adjunction again, \( \eps_C \after \bd{}{\a} (\molecin{u^\dagger}) = v^\a \).
%     This concludes the proof.
% \end{proof}

\cccom{Strategy}
\begin{itemize}
    \item define the function \( \nu \colon C \to \molecin{\N{}C} \), show by induction on \( n \) that all \( n \) dom globular cell of \( c \) of \( \molecin{\N{} C} \) are such that there is a reversible cylinder \( c \to \nu(\eps(c)) \) that is mapped via \( \eps \) to the identity (use the weak composite of \( \N{} C \) mapped, which generated basis element mapped to identity in \( C \))
    \item probably it is not possible without some kind of description of the elements of \( \molecin{\N{}C} \), in that \( \molecin{u} \) for \( u \in \Pd \N{} C \) is appropriately surjective. It is the case on the basis, but there are more possible compositions in \( \molecin{\N{}C} \) that there is a priori in \( \N{} C \), so this is quite difficult.
\end{itemize}


\begin{thm} \label{thm:cofibrant_replacement_counit_n}
    Let \( n \in \mathbb{N} \) and \( C \) be a stricter \( n \)\nbd category. 
    The the (derived) counit \( \eps_C \colon \N{n}\trunc{n}\molecin{C} \to C \) is an acyclic fibration in the folk model structure for stricter \( n \)\nbd categories.
\end{thm}
\begin{proof}
    \cccom{TODO}
\end{proof}

\subsection{Counit and cofibrant replacement}

\cccom{globe-like diagrammatic sets, restriction is acyclic-cofibration, stricter polygraph on globe like can recover all glob cell as pasting diagrams of theta}


\begin{lem} \label{lem:gray_determines_strict_functors}
    Let \( P, Q, P', Q' \) be regular directed complexes, and \( \F \colon \molecin{P} \to \molecin{P'} \), \( \G \colon \molecin{Q} \to \molecin{Q'} \) be strict functors.
    Then \( \F \gray \G \) extends to a strict functor 
    \begin{equation*}
        \F \gray \G \colon \molecin{P} \gray \molecin{Q} \to \molecin{P'} \gray \molecin{Q'}.
    \end{equation*}
\end{lem}
\begin{proof}
    Let \( w \colon W \to P \gray Q \) be a morphism.
    We show by induction on \( n \eqdef \dim w \) that \( (\F \gray \G) \after \molecin{w} \) is well defined. 
    The base case where \( n = 0 \) is clear.
    Inductively, suppose that \( n > 0 \).
    We show that for all 
    We show by induction on the dim morphism mi
\end{proof}