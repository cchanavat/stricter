\section{Strict and weak higher categories}

\subsection{Folk model structure on stricter \texorpdfstring{$\omega$}{Ï‰}-categories}

\begin{dfn} [Acyclic fibration] \label{dfn:acyclic_fibration}
    Let \( f \colon C \to D \) be a strict functor of compositions structures.
    We say that \( f \) is an \emph{acyclic fibration} if
    \begin{enumerate}
        \item \( f \) is surjective on objects;
        \item for each \( n \geq 0 \), each pair \( c, c' \) of parallel globular \( n \)\nbd cells of \( C \), and each globular \( (n + 1) \)\nbd cell \( v \colon f(c) \gcelto f(c') \), there exists a globular \( (n + 1) \)\nbd cell \( u \colon c \gcelto c' \) such that \( f(u) = v \)
    \end{enumerate}
\end{dfn}

\begin{dfn} [Reversible globular cell]
    Let \( C \) be a composition structure, and \( e \colon x \gcelto y \) be a globular cell of dimension \( n > 0 \) in \( C \).
    We say that \( e \) is reversible if there exists a globular cell \( e^* \colon y \gcelto x \), as well as globular cells \( h \colon e \comp{n - 1} e^* \gcelto x \) and \( h' \colon e^* \comp{n - 1} e \gcelto y \) such that \( h \) and \( h' \) are reversible.
    In that case, \( e^* \) is called a \emph{weak inverse} of \( e \).
    We write \( x \sim y \) if there exists a reversible globular cell \( e \) of type \( x \gcelto y \).
\end{dfn}

\begin{dfn} [\( \omega \)\nbd equivalence]
    Let \( f \colon C \to D \) be a strict functor of composition structures.
    We say that \( f \) is an \( \omega \)\nbd equivalence if
    \begin{enumerate}
        \item for each globular cell \( d \) in \( D \) of dimension \( 0 \), there exists a globular cell \( c \) in \( C \) such that \( f(c) \sim d \);
        \item for each \( n \geq 0 \), each pair \( c, c' \) of parallel globular \( n \)\nbd cells of \( C \), and each globular \( (n + 1) \)\nbd cell \( v \colon f(c) \gcelto f(c') \), there exists a globular \( (n + 1) \)\nbd cell \( u \colon c \gcelto c' \) such that \( f(u) \sim v \)
    \end{enumerate}
\end{dfn}

\begin{comm}
    The definitions of acyclic fibration, reversibility, and \( \omega \)\nbd equivalence make sense in any composition structure, in particular in a strict or stricter \( \omega \)\nbd category.
    In the former case, we recover the usual definitions, see for instance \cite[19.2.3, 20.1.1, 20.1.11]{ara2025polygraphs}.
\end{comm}

\begin{thm} \label{thm:folk_model_structure}
    There exists a model structure, called the \emph{folk model structure}, on \( \omegaCat \) such that:
    \begin{enumerate}
        \item the weak equivalences are the \( \omega \)\nbd equivalences;
        \item the acyclic fibrations are the one of Definition \ref{dfn:acyclic_fibration};
        \item every strict \( \omega \)\nbd category is fibrant. 
    \end{enumerate} 
\end{thm}
\begin{proof} 
    See \cite{lafont2010folk}.
\end{proof}

\noindent We conclude this section by giving an analogue to Theorem \ref{thm:folk_model_structure}, with \( \somegaCat \) in place of \( \omegaCat \).
We let 
\begin{equation*}
    \Icof \eqdef \set{i_n \colon \bd{}{} \globe{n} \incl \globe{n} \mid n \geq 0}.
\end{equation*}
By the small object argument in \( \somegaCat \), each strict functor \( f \colon C \to D \) of stricter \( \omega \)\nbd categories factors as \( f = p i \) where \( i \) is a relative stricter polygraph and \( p \) has the right lifting property against \( \Icof \), that is, \( p \) is an acyclic cofibration.

\begin{dfn} \label{dfn:generating_folk_acyclic_cof}
    For each \( n \geq 0 \), consider the strict functor \( \bd{}{} \globe{n + 1} \to \globe{n} \) sending the two non-trivial globular \( n \)\nbd cells of \( \bd{}{} \globe{n + 1} \) to the only non-trivial globular cell of \( \globe{n} \).
    We fix a factorisation of this strict functor
    \begin{equation*}
        \bd{}{} \globe{n + 1} \stackrel{j}{\to} \swE{n + 1} \stackrel{p}{\to} \globe{n}
    \end{equation*}
    into a stricter cofibration followed by an acyclic fibration, and let \( j_n \) be the composite
    \begin{equation*}
        \globe{n} \incl \bd{}{} \globe{n + 1} \stackrel{j}{\to} \swE{n + 1},
    \end{equation*}
    where \( \globe{n} \incl \bd{}{} \globe{n + 1} \) is the ``source'' inclusion, that is, the one factoring through \( \molecin{(\bd{}{-}\dglobe{n + 1})} \incl \molecin{\dglobe{n + 1}} \).
    We let
    \begin{equation*}
        \sJcof \eqdef \set{j_n \colon \globe{n} \to \swE{n + 1} \mid n \geq 0}.
    \end{equation*} 
\end{dfn}

\begin{dfn} [Stricter \( \omega \)\nbd category of cylinders]
    Let \( C \) be a stricter \( \omega \)\nbd category.
    The \emph{stricter \( \omega \)\nbd category of cylinder} is the stricter \( \omega \)\nbd category 
    \begin{equation*}
       \Gamma(C) \eqdef \homlax(\globe{1}, C). 
    \end{equation*}
\end{dfn}

\begin{rmk} \label{rmk:strict_stricter_same_cylinders}
    By Proposition \ref{prop:reflection_to_stricter_monoidal}, the stricter categories \( \Gamma(C) \) coincides with the strict \( \omega \)\nbd categories of cylinders \cite[Remark 20.2.9]{ara2025polygraphs}, which happen to be stricter, since \( C \) is.
\end{rmk}

\begin{thm} \label{thm:folk_model_structure_on_stricter}
    There is a cofibrantely generated model structure on the category \( \somegaCat \), called the \emph{folk model structure}, where:
    \begin{enumerate}
        \item \( \Icof \) is a set of generating cofibrations;
        \item \( \sJcof \) is a set of generating acyclic cofibrations;
        \item weak equivalences are the \( \omega \)\nbd equivalences;
        \item acyclic fibrations are the one of Definition \ref{dfn:acyclic_fibration}.
        \item all stricter \( \omega \)\nbd categories are fibrant;
        \item cofibrant objects are the stricter polygraphs.
    \end{enumerate}
    Furthermore, this model structure is right transferred from the folk model structure on \( \omegaCat \) along the adjunction 
    \begin{center}
        \begin{tikzcd}
            \somegaCat & \omegaCat,
            \arrow[""{name=0, anchor=center, inner sep=0}, "\iota"', curve={height=12pt}, hook, from=1-1, to=1-2]
            \arrow[""{name=1, anchor=center, inner sep=0}, "\rcs"', curve={height=12pt}, from=1-2, to=1-1]
            \arrow["\dashv"{anchor=center, rotate=-90}, draw=none, from=1, to=0]
        \end{tikzcd}
    \end{center}
    making it a Quillen adjunction.
\end{thm}
\begin{proof}
    This is a direct application of \cite[Proposition 21.3.2]{ara2025polygraphs} with Remark \ref{rmk:strict_stricter_same_cylinders}, noticing that \( \rcs \Icof = \Icof \), and that, by \cite[20.4.7]{ara2025polygraphs}, a generating set \( \Jcof \) of acyclic cofibrations for the folk model structure on \( \omegaCat \) is given by the same construction as (\ref{dfn:generating_folk_acyclic_cof}), but computing the small objects argument in \( \omegaCat \) instead of \( \somegaCat \).
    As a consequence, the classes \( \llp(\rlp(\rcs\Jcof)) \) and \( \llp(\rlp(\sJcof)) \) coincide.
\end{proof}

\begin{rmk} 
    By Lemma \ref{lem:pushout_principal_cell}, the set
    \begin{equation*}
        \set{\molecin{\bd{}{}U} \incl \molecin{U} \mid U \text{ atom}}
    \end{equation*}
    is also a generating set of acyclic cofibrations for the folk model structure on \( \somegaCat \), whose cofibrations are therefore given by the retracts of relative polygraphs.
\end{rmk}

\noindent Finally, we fix \( n \in \mathbb{N} \), and let
\begin{equation*}
    \Icof_n \eqdef \trunc{n}\Icof,\quad\quad \sJcof_n \eqdef \trunc{n}\Jcof.
\end{equation*}

\begin{thm} \label{thm:folk_model_structure_on_stricter_n}
    There is a cofibrantely generated model structure on the category \( \snCat{n} \), called the \emph{folk model structure}, where:
    \begin{enumerate}
        \item \( \Icof_n \) is a set of generating cofibrations;
        \item \( \sJcof_n \) is a set of generating acyclic cofibrations;
        \item weak equivalences are the \( \omega \)\nbd equivalences;
    \end{enumerate}
    Furthermore, this model structure is right transferred from the folk model structure on \( \nCat{n} \) along the adjunction 
    \begin{center}
        \begin{tikzcd}
            \snCat{n} & \nCat{n},
            \arrow[""{name=0, anchor=center, inner sep=0}, "\iota"', curve={height=12pt}, hook, from=1-1, to=1-2]
            \arrow[""{name=1, anchor=center, inner sep=0}, "\rcs"', curve={height=12pt}, from=1-2, to=1-1]
            \arrow["\dashv"{anchor=center, rotate=-90}, draw=none, from=1, to=0]
        \end{tikzcd}
    \end{center}
    making it a Quillen adjunction.
\end{thm}
\begin{proof}
    Same as Theorem \ref{thm:folk_model_structure_on_stricter}.
\end{proof}

\noindent Therefore, we have the following commutative square of left Quillen functors
\begin{center}
    \begin{tikzcd}
        \omegaCat & \somegaCat \\
        {\nCat{n}} & {\snCat{n}.}
        \arrow["\rcs", from=1-1, to=1-2]
        \arrow["{\trunc{n}}"', from=1-1, to=2-1]
        \arrow["{\trunc{n}}", from=1-2, to=2-2]
        \arrow["\rcs"', from=2-1, to=2-2]
    \end{tikzcd}
\end{center}

\subsection{Coherent walking equivalence}

We let \( \molecin{-} \colon \dgmSet \to \somegaCat \) be the left Kan extension along the Yoneda embedding of the functor \( \atom \to \somegaCat \) defined by \( U \mapsto \molecin{U} \).
Notice that by Corollary \ref{cor:regular_directed_complex_colimit_of_itself}, there is no ambiguity when one writes \( \molecin{P} \) for a regular directed complex \( P \).

\begin{lem} \label{lem:molecin_preserves_cofibration}
    Let \( f \colon X \incl Y \) be a monomorphism of diagrammatic sets.
    Then \( \molecin{f} \) is a relative stricter polygraph.
\end{lem}
\begin{proof}
    Let \( I \eqdef \set{\bd{}{} U \incl U \mid U \text{ atom}} \).
    Then \( f \) is a relative \( I \)\nbd cell complex by \cite[Remark 2.9]{chanavat2024htpy}.
    Since \( \molecin{-} \) is left adjoint, \( \molecin{f} \) is a relative \( \molecin{I} \)\nbd cell complex, i.e. a relative stricter polygraph.
\end{proof}

\begin{cor} \label{cor:molecin_polygraph_with_basis}
    Let \( X \) be a diagrammatic set. 
    Then \( \molecin{X} \) is a stricter polygraph with generating set \( \cls{S} = \coprod_{k \geq 0} \cls{S}_k \), where
    \begin{equation*}
        \cls{S}_k \eqdef \set{\molecin{u} \colon \molecin{U} \to \molecin{X} \mid u \colon U \to X \in \gr{k}{\nd X}}.
    \end{equation*}
\end{cor}

\begin{lem} \label{lem:molecin_monoidal}
    The functor \( \molecin{-} \colon \dgmSet \to \somegaCat \) is monoidal with respect to the Gray product of diagrammatic sets and stricter \( \omega \)\nbd categories.
\end{lem}
\begin{proof}
    The result is true on atoms by definition of the Gray product of stricter \( \omega \)\nbd categories.
    We conclude by universal property of the Gray product.
\end{proof}

\begin{dfn} 
    We recall from \cite{hadzihasanovic2024model} the construction of the \emph{coherent walking equivalence \( \wE \)}, which is a strict \( \omega \)\nbd category equipped with an inclusion \( \globe{0} \incl \wE \).
    We define \( \wE \) as a transfinite composition of inclusions \( \order{n}{\wE} \incl \order{n + 1}{\wE} \) such that
    \begin{itemize}
        \item \( \order{n}{\wE} \) is a strict \( n \)\nbd category, and
        \item for \( n \geq 1 \), \( \order{n}{\wE} \) is equipped with strict functors \( \iota_n \colon \order{n - 1}{\wE} \to \order{n}{\wE} \),
    as well as \( \fun{L}_k, \fun{R}_k \colon \sus{\order{n - 1}{\wE}} \to \wE \).
    \end{itemize}
    Then, \( \order{0}{\wE} \) is the set with two elements \( \set{x, y} \) and \( \order{1}{\wE} \) is the free category on three generators \( \set{a \colon x \to y, a^L \colon y \to x, a^R \colon y \to x} \), equipped with the evident inclusion \( \iota_1 \colon \set{x, y} \incl \order{1}{\wE} \), and
    \begin{equation*}
        \fun{L}_1 \colon \sus{x} \mapsto a \comp{0} a^L, \sus{y} \mapsto x, \quad\text{ and }\quad \fun{R}_1 \colon \sus{x} \mapsto a^R \comp{0} a, \sus{y} \mapsto y
    \end{equation*}

    Let \( k > 1 \), and suppose that \( (\order{k - 1}{\wE}, \iota_{k - 1}, \fun{L}_{k - 1}, \fun{R}_{k - 1}) \) have been defined.
    Then \( (\order{k}{\wE}, \iota_{k}, \fun{L}_{k}, \fun{R}_{k}) \) is defined by the pushout
    \begin{center}
        \begin{tikzcd}[column sep=huge]
            {\sus{\order{k - 2}{\wE}} \coprod \sus{\order{k - 2}{\wE}}} & {\order{k - 1}{\wE}} \\
            {\sus{\order{k - 1}{\wE}} \coprod \sus{\order{k - 1}{\wE}}} & {\order{k}{\wE}}
            \arrow[""{name=0, anchor=center, inner sep=0}, "{(\fun{L}_{k-1},\fun{R}_{k-1})}", from=1-1, to=1-2]
            \arrow["{\sus{\iota_{k-1}} \coprod \sus{\iota_{k-1}}}"', from=1-1, to=2-1]
            \arrow["{\iota_k}", from=1-2, to=2-2]
            \arrow["{(\fun{L}_k,\fun{R}_k)}"', from=2-1, to=2-2]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
        \end{tikzcd}
    \end{center}
    in \( \omegaCat \).
    The inclusion \( \globe{0} \incl \wE \) then classifies \( x \in \order{0}{\wE} \).
    We denote by \( \fun{L}_\infty, \fun{R}_\infty \colon \sus{\wE} \to \wE \) the transfinite composition of \( (\fun{L}_k)_k \) and \( (\fun{R}_k)_k \) respectively.
\end{dfn}

\begin{dfn} [Stricter coherent walking equivalence]
    The \emph{stricter coherent walking equivalence} is the stricter \( \omega \)\nbd category \( \swE \eqdef \rcs \wE \), which comes equipped with the inclusion \( j \colon \globe{0} \incl \swE \).
\end{dfn}

\begin{lem} \label{lem:inclusion_into_stricter_is_equivalence}
    The inclusion \( j \colon \globe{0} \incl \swE \) is an acyclic cofibration in the folk model structure on stricter \( \omega \)\nbd categories.
\end{lem}
\begin{proof}
    Let \( i \colon \dglobe{0} \incl \wE \) be the inclusion of strict \( \omega \)\nbd categories such that \( j = \rcs i \).
    By \cite[Remark 1.29, Theorem 1.33]{hadzihasanovic2024model} and the two-out-of-three, \( i \) a cofibration and a weak equivalence.
    By Theorem \ref{thm:folk_model_structure_on_stricter}, \( j \) is an acyclic cofibration. 
\end{proof}

\begin{lem} \label{lem:swE_is_iso_to_molecin_loc_globe}
    The stricter \( \omega \)\nbd categories \( \swE \) and \( \molecin{\rglobe{1}} \) are isomorphic.
\end{lem}
\begin{proof}
    By \cite[Remark 1.29]{hadzihasanovic2024model}, \( \swE \) is the stricter polygraph whose \( k \)\nbd globular cells are
    generated by the set \( \cls{S}_k \), which can be describe inductively as
    \begin{equation*}
        \cls{S}_0 = \set{x, y}, \cls{S}_1 = \set{a, a^L, a^R},
    \end{equation*} 
    and for \( k > 1 \),
    \begin{equation*}
        \cls{S}_k = \set{\fun{L}_\infty(\sus{t}), \fun{R}_\infty(\sus{t}) \mid t \in \cls{S}_{k - 1}}.
    \end{equation*}
    Letting \( \fun{L} \eqdef \fun{L}_\infty(\sus{}) \) and \( \fun{R} \eqdef \fun{R}_\infty(\sus{}) \), we can then canonically identify elements of \( \cls{S}_k \)
    as 
    \begin{equation*}
        \cls{S}_k \cong \set{(a, s), (a^L, s), (a^R, s) \mid s \in \set{L, R}^*},
    \end{equation*}
    such that, for instance, \( (a, sL) = \fun{L}_\infty(\sus{(a, s)}) \).
    By Corollary \ref{cor:molecin_polygraph_with_basis}, \( \molecin{\rglobe{1}} \) is the stricter polygraph whose generating set is given, in the notation of (\ref{dfn:localisation}) by \( \coprod_{k \geq 0} \cls{T}_k \), where, letting \( b \colon \dglobe{1} \to \dglobe{1} \) be the identity, 
    \begin{equation*}
        \cls{T}_0 = \set{0^-, 0^+}, \cls{T}_1 = \set{b, b^L, b^R},
    \end{equation*}
    and for \( k > 1 \),
    \begin{equation*}
        \cls{T}_k = \set{\hinv{s}b, (\hinv{s}b)^L, (\hinv{s}b)^R \mid s \in \set{L, R}^{k - 1}}.
    \end{equation*}
    Then, we define inductively on \( k \geq 0 \) a family of bijections \( \phi_k \colon \cls{T}_k \cong \cls{S}_k \) such that by \( (0^-, 0^+) \mapsto (x, y) \), and inductively for \( k > 0 \),
    \begin{equation*}
        \hinv{s}b \mapsto (b, s),\quad (\hinv{s}b)^L \mapsto (b^L, s),\quad (\hinv{s}b)^R \mapsto (b^R, s).
    \end{equation*}
    One checks that \( \phi \) induces a strict functor which is an isomorphism.
    This concludes the proof.
\end{proof}

\begin{lem} \label{lem:suspension_commute_selfloc} \ccnote{say what is connected}
    Let \( U \) be an atom of dimension \( \geq 1 \).
    Then \( \sus{\selfloc{U}} \) and \( \selfloc{\sus{U}} \) are isomorphic. 
\end{lem}
\begin{proof}
    By \cite[Lemma 3.3.13]{hadzihasanovic2024combinatorics}, \( U \) is connected.
    Then by induction on the construction of the localisation, it is clear that \( \selfloc{U} \) is connected.
    Therefore, by Proposition \ref{prop:suspension_of_dgmSet}, 
    \begin{equation*}
        \sus{\left(\colim_{v \colon V \to \selfloc{U}} V\right)} \cong \colim_{v \colon V \to \selfloc{U}} \sus{V}
    \end{equation*}
    Then, for all \( s \in \set{L, R}^* \), \( \sus{\hcyl{s}U} \) and \( \hcyl{s} \sus{U} \) are isomorphic.
    By induction on the construction of the localisation, \( \selfloc{\sus{U}} \) and \( \colim\limits_{v \colon V \to \selfloc{U}} \sus{V} \) are isomorphic.    
    This concludes the proof.
\end{proof}

\begin{lem} \label{lem:sus_commute_molec_connected}
    Let \( X \) be a connected diagrammatic set.
    Then \( \molecin{\sus{X}} \) and \( \sus{\molecin{X}} \) are isomorphic.
\end{lem}
\begin{proof}
    Follows by Corollary \ref{cor:adjunction_hom_suspension} and Proposition \ref{prop:suspension_of_dgmSet}. 
\end{proof}

\begin{prop} \label{prop:walking_eq_of_dim_n}
    Let \( n \geq 0 \), and call \( i_n \colon \dglobe{n + 1} \to \rglobe{n + 1} \) the canonical inclusion.
    Then 
    \begin{equation*}
        \molecin{(\bd{}{-} i_n)} \colon \molecin{\dglobe{n}} \to \molecin{\rglobe{n + 1}} 
    \end{equation*}
    is an acyclic cofibration in the folk model structure for stricter \( \omega \)\nbd categories.
\end{prop}
\begin{proof}
    By Lemma \ref{lem:inclusion_into_stricter_is_equivalence} and Lemma \ref{lem:swE_is_iso_to_molecin_loc_globe}, \( \molecin{(\bd{}{-} i_0)} \) is an acyclic cofibration.
    By a straightforward variation of \cite[Proposition 2.8]{hadzihasanovic2024model}, the functor \( \sus{} \colon \somegaCat \to \somegaCat \) preserves acyclic cofibrations, therefore \( \sus{\molecin{(\bd{}{-} i_0)}}^n \) is a acyclic cofibration.
    Using Lemma \ref{lem:sus_commute_molec_connected} and Lemma \ref{lem:suspension_commute_selfloc}, one sees that \( \sus{\molecin{(\bd{}{-} i_0)}}^n \) is in fact isomorphic to \( \molecin{(\bd{}{-} i_n)} \).
    This concludes the proof.
\end{proof}

\subsection{Quillen adjunction}

\begin{lem} \label{lem:pushout_with_localisation}
    Let \( c \colon U \to V \) be a subdivision between atoms of dimension \( \geq 1 \)
    Then there is a strict functor \( \td{c} \colon \molecin{\rglobe{n}} \to \molecin{\selfloc U} \) fitting in a pushout diagram
    \begin{center}
        \begin{tikzcd}
            {\molecin{\dglobe n}} & {\molecin{\rglobe n}} \\
            {\molecin{U}} & {\molecin{\selfloc U}}
            \arrow[""{name=0, anchor=center, inner sep=0}, hook, from=1-1, to=1-2]
            \arrow["{\molecin{c}}"', from=1-1, to=2-1]
            \arrow["{\tilde c}", from=1-2, to=2-2]
            \arrow[hook, from=2-1, to=2-2]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
        \end{tikzcd}
    \end{center}
\end{lem}
\begin{proof}
    Let \( n \geq 1 \) be the dimension of \( U \)
    Let \( u \colon U \to U \) and \( v \colon V \to V \) be the identity.
    For each \( k \geq 0 \), let \( \order{k}{U} \) and \( \order{k}{V} \) be the marked diagrammatic sets corresponding respectively to the \( n \)\nbd step of the localisation as in (\ref{dfn:localisation}).
    Note that we have
    \begin{align*}
        \nd \gr{n + k}{\order{k}{U}} &= \set{\hinv{s}u \colon \hcyl{s} U \to \order{k - 1}{U}, \hinv{s}^Lu, \hinv{s}^Ru \colon \dual{n + k}{\hcyl{s} U} \to \order{k - 1}{U}}_{s \in \set{L, R}^k},\\
        \nd \gr{n + k}{\order{k}{V}} &= \set{\hinv{s}v \colon \hcyl{s} V \to \order{k - 1}{V}, \hinv{s}^Lv, \hinv{s}^Rv \colon \dual{n + k}{\hcyl{s} V} \to \order{k - 1}{U}}_{s \in \set{L, R}^k}.
    \end{align*}
    We will then show by induction on \( k \geq 0 \) that letting \( c_0 \eqdef \molecin{c} \), and for all \( k > 0 \), that \( c_k \colon \molecin{\order{k}{U}} \to \molecin{\order{k}{V}} \) by letting, for all \( s \in \set{L, R}^k \),
    \begin{equation*}
        \hinv{s}u \mapsto \hinv{s}v,\quad \hinv{s}^Lu, \mapsto \hinv{s}^Lv,\quad \hinv{s}^Ru, \mapsto \hinv{s}^Rv,
    \end{equation*}
    is a well defined strict functor fitting in a pushout square
    \begin{center} \label{tik:inductive_square_subdivision_localisation}
        \begin{tikzcd}
            {\molecin U} & {\molecin{\order k U}} \\
            {\molecin V} & {\molecin {\order k V}.}
            \arrow[""{name=0, anchor=center, inner sep=0}, from=1-1, to=1-2]
            \arrow["{c_0}"', from=1-1, to=2-1]
            \arrow["{c_k}", from=1-2, to=2-2]
            \arrow[from=2-1, to=2-2]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
        \end{tikzcd}
    \end{center}
    The base case is evident.
    Inductively, let \( k > 0 \).
    To make the following diagrams more readable, we omit writing \( \molecin{(-)} \). 
    Then \( {\molecin{\order k U}} \) and \( {\molecin{\order k V}} \) are produced from \( {\molecin{\order {k - 1} U}} \) and \( {\molecin{\order {k - 1} V}} \) by first attaching left and right inverses of the elements of the form \( \hinv{s}u \) and \( \hinv{s}v \) for \( s \in \set{L, R}^{k - 1} \), giving the following pushouts in \( \somegaCat \)
    \begin{center}
        \begin{tikzcd}
            {\coprod\limits_{s \in \set{L, R}^{k - 1}} \bd{}{}\dual{n + k - 1}{\hcyl{s}U}} & {\coprod\limits_{s \in \set{L, R}^{k - 1}} \dual{n + k - 1}{\hcyl{s}U}} \\
            {\order{k - 1} U} & {U'}
            \arrow[""{name=0, anchor=center, inner sep=0}, from=1-1, to=1-2]
            \arrow[from=1-1, to=2-1]
            \arrow[from=1-2, to=2-2]
            \arrow[from=2-1, to=2-2]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
        \end{tikzcd}
    \end{center}
    and 
    \begin{center}
        \begin{tikzcd}
            {\coprod\limits_{s \in \set{L, R}^{k - 1}} \bd{}{}\dual{n + k - 1}{\hcyl{s}V}} & {\coprod\limits_{s \in \set{L, R}^{k - 1}} \dual{n + k - 1}{\hcyl{s}V}} \\
            {\order{k - 1} V} & {V'}
            \arrow[""{name=0, anchor=center, inner sep=0}, from=1-1, to=1-2]
            \arrow[from=1-1, to=2-1]
            \arrow[from=1-2, to=2-2]
            \arrow[from=2-1, to=2-2]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
        \end{tikzcd}
    \end{center}
    By Lemma \ref{lem:subdivision_of_invertors}, Lemma \ref{lem:pushout_principal_cell}, we have the pushout square
    \begin{center}
        \begin{tikzcd}
            {\coprod\limits_{s \in \set{L, R}^{k - 1}} \bd{}{}\dual{n + k - 1}{\hcyl{s}U}} & {\coprod\limits_{s \in \set{L, R}^{k - 1}} \dual{n + k - 1}{\hcyl{s}U}} \\
            {\coprod\limits_{s \in \set{L, R}^{k - 1}} \bd{}{}\dual{n + k - 1}{\hcyl{s}V}} & {\coprod\limits_{s \in \set{L, R}^{k - 1}} \dual{n + k - 1}{\hcyl{s}V}}
            \arrow[""{name=0, anchor=center, inner sep=0}, from=1-1, to=1-2]
            \arrow[from=1-1, to=2-1]
            \arrow["{\coprod \dual{n + k - 1}{\hcyl{s}c}}", from=1-2, to=2-2]
            \arrow[from=2-1, to=2-2]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
        \end{tikzcd}
    \end{center}
    Combined with the inductive pushout square (\ref{tik:inductive_square_subdivision_localisation}), pasting law for pushouts therefore gives a strict functor \( c' \colon \molecin{U'} \to \molecin{V'} \) being the pushout of \( c_k \) along \( \molecin{\order{k - 1}{U}} \to \molecin{U'} \).
    Finally, \( \molecin{\order k U} \) and \(  {\molecin{\order k V}} \) are given by the following cellular extensions of \( U' \) and \( V' \):
    \begin{center}
        \begin{tikzcd}[column sep=small]
            {\coprod\limits_{s \in \set{L, R}^k} \bd{}{}\hcyl{s}U} & {\coprod\limits_{s \in \set{L, R}^k} \hcyl{s}U} & {\coprod\limits_{s \in \set{L, R}^k} \bd{}{}\hcyl{s}V} & {\coprod\limits_{s \in \set{L, R}^k} \hcyl{s}V} \\
            {U'} & {\order k U} & {V'} & {\order k V}.
            \arrow[""{name=0, anchor=center, inner sep=0}, from=1-1, to=1-2]
            \arrow[from=1-1, to=2-1]
            \arrow[from=1-2, to=2-2]
            \arrow[""{name=1, anchor=center, inner sep=0}, from=1-3, to=1-4]
            \arrow[from=1-3, to=2-3]
            \arrow[from=1-4, to=2-4]
            \arrow[from=2-1, to=2-2]
            \arrow[from=2-3, to=2-4]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=0]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-4, to=1]
        \end{tikzcd}
    \end{center}
    By a similar argument, the pushout of \( c' \colon  \molecin{U'} \to \molecin{V'} \) along the strict functor \( \molecin{U'} \to \molecin{\order{k}{U}} \) is \( c_k \colon \molecin{\order{k}{U}} \to \molecin{\order{k}{V}} \).
    The pasting law for pushout concludes the inductive step.
    By transfinite composition \( \tilde{c} \colon \molecin{\selfloc{U}} \to \molecin{\selfloc{V}} \) is the pushout of \( \molecin{c} \) along \( \molecin{U} \to \molecin{\selfloc U} \).
\end{proof}

\begin{prop} \label{prop:molecin_send_Jcomp_to_acof}
    Let \( U \) be a round molecule.
    Then
    \begin{equation*}
        \molecin{c_U} \colon \molecin{U} \to \molecin{(U \simeq \compos{U})}
    \end{equation*}
    is an acyclic cofibration in the folk model structure for strict \( \omega \)\nbd categories.
\end{prop}
\begin{proof}
    Let \( n \eqdef \dim U \), and \( s \colon \dglobe{n} \to U \) be the unique subdivision.
    By Lemma \ref{lem:pushout_with_localisation}, we have the four commutative squares
    \begin{center}
        \begin{tikzcd}[column sep=small]
            {\molecin{\dglobe n}} & {\molecin{\bd{}{}{\dglobe {n + 1}}}} & {\molecin{\dglobe {n + 1}}} & {\molecin{\rglobe {n + 1}}} \\
            {\molecin U} & {\molecin{\bd{}{}(U \celto \compos U)}} & {\molecin{(U \celto \compos U)}} & {\molecin{(U \simeq \compos U)}}
            \arrow[from=1-1, to=1-2]
            \arrow["{\molecin{s}}"', from=1-1, to=2-1]
            \arrow[""{name=0, anchor=center, inner sep=0}, from=1-2, to=1-3]
            \arrow[from=1-2, to=2-2]
            \arrow[""{name=1, anchor=center, inner sep=0}, from=1-3, to=1-4]
            \arrow[from=1-3, to=2-3]
            \arrow[from=1-4, to=2-4]
            \arrow[from=2-1, to=2-2]
            \arrow[from=2-2, to=2-3]
            \arrow[from=2-3, to=2-4]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-3, to=0]
            \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-4, to=1]
        \end{tikzcd}
    \end{center}
    where the middle and right squares are pushouts.
    The composite of the top horizontal strict functors is an acyclic cofibration by Proposition \ref{prop:walking_eq_of_dim_n}.
    Since acyclic cofibrations are stable under pushouts, it is enough by the pasting law for pushout to show that the left square is a pushout.
    In the following commutative cube
    \begin{center}
        \begin{tikzcd}
            {\molecin{\bd{}{}\dglobe n}} & {\molecin{\dglobe n}} \\
            {\molecin{\bd{}{}U}} & {\molecin{\compos U}} \\
            && {\molecin{\dglobe n}} & {\molecin{\bd{}{}{\dglobe {n + 1}}}} \\
            && {\molecin U} & {\molecin{\bd{}{}(U \celto \compos U)}}
            \arrow[from=1-1, to=1-2]
            \arrow[from=1-1, to=2-1]
            \arrow[curve={height=12pt}, from=1-1, to=3-3]
            \arrow[dashed, from=1-2, to=2-2]
            \arrow[curve={height=-12pt}, from=1-2, to=3-4]
            \arrow[from=2-1, to=2-2]
            \arrow[curve={height=12pt}, from=2-1, to=4-3]
            \arrow[curve={height=-12pt}, dashed, from=2-2, to=4-4]
            \arrow[from=3-3, to=3-4]
            \arrow["{\molecin{s}}"', from=3-3, to=4-3]
            \arrow[from=3-4, to=4-4]
            \arrow[from=4-3, to=4-4]
        \end{tikzcd}
    \end{center}
    the back face is a pushout by Lemma \ref{lem:pushout_principal_cell}.
    The top and bottom face are pushouts since they are cellular extensions.
    By the pasting law for pushouts, the front face is a pushout as desired.
\end{proof}

\begin{dfn} [Diagrammatic nerve]
    The \emph{diagrammatic nerve} is the right adjoint \( \N{} \) to the functor \( \molecin{-} \).
    For \( n \in \mathbb{N} \), the \( n \)\nbd truncated diagrammatic nerve is the right adjoint \( \N{n} \) to the functor \( \trunc{n} \after \molecin{-} \).
\end{dfn}


\begin{thm} \label{thm:quillen_folk_dgm_infty}
    The folk model structure on stricter \( \omega \)\nbd categories is right transferred along the diagrammatic nerve \( \N{} \colon \somegaCat \to \dgmSet \).
    In particular, the adjunction 
    \begin{equation*}
        \molecin{-} \colon \dgmSet \leftrightarrows \somegaCat \cocolon \N{}
    \end{equation*}
    is a Quillen adjunction between the \( (\infty, \infty) \)\nbd model structure on diagrammatic sets and the folk model structure on stricter \( \omega \)\nbd categories
\end{thm}
\begin{proof}
    Recall from Theorem \ref{thm:n_model_structure_on_dgm_set} that \( I \eqdef \set{\bd{}{} U \incl U \mid U \text{ atom}} \) is a generating set of cofibrations for the \( (\infty, \infty) \)\nbd model structure on diagrammatic sets, while \( \Jcomp \) is a pseudo-generating set of acyclic cofibration. 
    By Lemma \ref{lem:molecin_preserves_cofibration}, Proposition \ref{prop:molecin_send_Jcomp_to_acof}, \( \molecin{-} \) preserves cofibrations and a pseudo-generating set of acyclic cofibrations.
    By \cite[E.2.14]{joyal2008theory}, \( \molecin{-} \) is left Quillen. 
    Since all objects are fibrant in the folk model structure, Ken Brown's Lemma implies that \( \N{} \) preserves all weak equivalences, and in particular acyclic cofibrations. 
    Thus, \( \N{} \) takes relative \( \molecin{\Jcomp} \)\nbd complexes to weak equivalences.
    By \cite[Theorem 11.3.2]{hirschhorn2003model}, there exists a model structure on \( \somegaCat \), let us call it the transferred model structure, cofibrantely generated by \( \molecin{I} \) and \( \molecin{\Jcomp} \).
    Since \( \molecin{I} \) contains the generating cofibration of the folk model structure, the transferred and the folk model structure have the same cofibrations.
    Since all stricter \( \omega \)\nbd categories are fibrant in the folk model structure, they have in particular the right lifting property against \( \molecin{\Jcomp} \).
    Thus all stricter \( \omega \)\nbd categories are fibrant in the transferred model structure.
    By \cite[Proposition E.1.10]{joyal2008theory}, the transferred and the folk model structure coincide.
    This concludes the proof.
\end{proof}

\begin{cor}\label{cor:quillen_folk_dgm_n}\cccom{maybe: do uniform n, repalce infty by omega in dgm}
    Let \( n \in \mathbb{N} \).
    Then the folk model structure on stricter \( n \)\nbd categories is right transferred along the \( n \)\nbd truncated diagrammatic nerve \( \N{n} \colon \snCat{n} \to \dgmSet \).
    In particular, the adjunction 
    \begin{equation*}
        \molecin{-} \colon \dgmSet \leftrightarrows \snCat{n} \cocolon \N{n}
    \end{equation*}
    is a Quillen adjunction between the \( (\infty, n) \)\nbd model structure on diagrammatic sets and the folk model structure on stricter \( n \)\nbd categories
\end{cor}
\begin{proof}
    A look at the generating cofibrations and acyclic cofibration of Theorem \ref{thm:folk_model_structure_on_stricter_n} indicates that the folk model structure on stricter \( n \)\nbd categories is right transferred along the right adjoint inclusion \( \snCat{n} \incl \somegaCat \).  
    In particular, the functor \( \trunc{n} \colon \somegaCat \to \snCat{n} \) is left Quillen.
    Let \( U \) be an atom of dimension \( > n \), and \( i \colon U \incl U \) be the canonical inclusion.
    A direct inspection and Corollary \ref{cor:molecin_polygraph_with_basis} show that \( \trunc{n}\molecin{i} \) is an isomorphism.
    Thus \( \trunc{n} \after \molecin{(\Jcomp \cup \Jn{n})} \) is a set of acyclic cofibrations.
    By \cite[E.2.14]{joyal2008theory}, \( \molecin{-} \) is left Quillen. 
    Since ``being right transferred'' is a compatible with composition of right Quillen functors, we conclude by Theorem \ref{thm:quillen_folk_dgm_infty}.
\end{proof}

\begin{thm} \label{thm:cofibrant_replacement_counit}
    Let \( n \in \mathbb{N} \cup \set{\omega} \), and \( C \) be a stricter \( n \)\nbd category.
\end{thm}
\begin{proof}
    \cccom{TODO}
\end{proof}
